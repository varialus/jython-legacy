<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>What’s New in Python 2.6 &mdash; Jython v2.5.0 documentation</title>
    <link rel="stylesheet" href="../_static/green-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.5.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="Jython v2.5.0 documentation" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../index.html">Jython v2.5.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/jython.png" alt="Logo"/>
            </a></p>
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">What&#8217;s New in Python 2.6</a><ul>
<li><a class="reference external" href="#python-3-0">Python 3.0</a></li>
<li><a class="reference external" href="#changes-to-the-development-process">Changes to the Development Process</a><ul>
<li><a class="reference external" href="#new-issue-tracker-roundup">New Issue Tracker: Roundup</a></li>
<li><a class="reference external" href="#new-documentation-format-restructuredtext-using-sphinx">New Documentation Format: reStructuredText Using Sphinx</a></li>
</ul>
</li>
<li><a class="reference external" href="#pep-343-the-with-statement">PEP 343: The &#8216;with&#8217; statement</a><ul>
<li><a class="reference external" href="#writing-context-managers">Writing Context Managers</a></li>
<li><a class="reference external" href="#the-contextlib-module">The contextlib module</a></li>
</ul>
</li>
<li><a class="reference external" href="#pep-366-explicit-relative-imports-from-a-main-module">PEP 366: Explicit Relative Imports From a Main Module</a></li>
<li><a class="reference external" href="#pep-370-per-user-site-packages-directory">PEP 370: Per-user <tt class="docutils literal"><span class="pre">site-packages</span></tt> Directory</a></li>
<li><a class="reference external" href="#pep-371-the-multiprocessing-package">PEP 371: The <tt class="docutils literal"><span class="pre">multiprocessing</span></tt> Package</a></li>
<li><a class="reference external" href="#pep-3101-advanced-string-formatting">PEP 3101: Advanced String Formatting</a></li>
<li><a class="reference external" href="#pep-3105-print-as-a-function">PEP 3105: <tt class="docutils literal"><span class="pre">print</span></tt> As a Function</a></li>
<li><a class="reference external" href="#pep-3110-exception-handling-changes">PEP 3110: Exception-Handling Changes</a></li>
<li><a class="reference external" href="#pep-3112-byte-literals">PEP 3112: Byte Literals</a></li>
<li><a class="reference external" href="#pep-3116-new-i-o-library">PEP 3116: New I/O Library</a></li>
<li><a class="reference external" href="#pep-3118-revised-buffer-protocol">PEP 3118: Revised Buffer Protocol</a></li>
<li><a class="reference external" href="#pep-3119-abstract-base-classes">PEP 3119: Abstract Base Classes</a></li>
<li><a class="reference external" href="#pep-3127-integer-literal-support-and-syntax">PEP 3127: Integer Literal Support and Syntax</a></li>
<li><a class="reference external" href="#pep-3129-class-decorators">PEP 3129: Class Decorators</a></li>
<li><a class="reference external" href="#pep-3141-a-type-hierarchy-for-numbers">PEP 3141: A Type Hierarchy for Numbers</a><ul>
<li><a class="reference external" href="#the-fractions-module">The <tt class="docutils literal"><span class="pre">fractions</span></tt> Module</a></li>
</ul>
</li>
<li><a class="reference external" href="#other-language-changes">Other Language Changes</a><ul>
<li><a class="reference external" href="#optimizations">Optimizations</a></li>
<li><a class="reference external" href="#interpreter-changes">Interpreter Changes</a></li>
</ul>
</li>
<li><a class="reference external" href="#new-improved-and-deprecated-modules">New, Improved, and Deprecated Modules</a><ul>
<li><a class="reference external" href="#the-ast-module">The <tt class="docutils literal"><span class="pre">ast</span></tt> module</a></li>
<li><a class="reference external" href="#the-future-builtins-module">The <tt class="docutils literal"><span class="pre">future_builtins</span></tt> module</a></li>
<li><a class="reference external" href="#the-json-module-javascript-object-notation">The <tt class="docutils literal"><span class="pre">json</span></tt> module: JavaScript Object Notation</a></li>
<li><a class="reference external" href="#the-plistlib-module-a-property-list-parser">The <tt class="docutils literal"><span class="pre">plistlib</span></tt> module: A Property-List Parser</a></li>
<li><a class="reference external" href="#ctypes-enhancements">ctypes Enhancements</a></li>
<li><a class="reference external" href="#improved-ssl-support">Improved SSL Support</a></li>
</ul>
</li>
<li><a class="reference external" href="#build-and-c-api-changes">Build and C API Changes</a><ul>
<li><a class="reference external" href="#port-specific-changes-windows">Port-Specific Changes: Windows</a></li>
<li><a class="reference external" href="#port-specific-changes-mac-os-x">Port-Specific Changes: Mac OS X</a></li>
<li><a class="reference external" href="#port-specific-changes-irix">Port-Specific Changes: IRIX</a></li>
</ul>
</li>
<li><a class="reference external" href="#porting-to-python-2-6">Porting to Python 2.6</a></li>
<li><a class="reference external" href="#acknowledgements">Acknowledgements</a></li>
</ul>
</li>
</ul>

            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/whatsnew/2.6.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="what-s-new-in-python-2-6">
<h1>What&#8217;s New in Python 2.6<a class="headerlink" href="#what-s-new-in-python-2-6" title="Permalink to this headline">¶</a></h1>
<dl class="docutils">
<dt>Author:</dt>
<dd>A.M. Kuchling (amk at amk.ca)</dd>
<dt>Release:</dt>
<dd>2.6.2</dd>
<dt>Date:</dt>
<dd>July 31, 2009</dd>
</dl>
<p>This article explains the new features in Python 2.6, released on
October 1 2008.  The release schedule is described in <strong>PEP 361</strong>.</p>
<p>The major theme of Python 2.6 is preparing the migration path to
Python 3.0, a major redesign of the language.  Whenever possible,
Python 2.6 incorporates new features and syntax from 3.0 while
remaining compatible with existing code by not removing older features
or syntax.  When it&#8217;s not possible to do that, Python 2.6 tries to do
what it can, adding compatibility functions in a <tt class="docutils literal"><span class="pre">future_builtins</span></tt>
module and a <em>-3</em> switch to warn about usages that will become
unsupported in 3.0.</p>
<p>Some significant new packages have been added to the standard library,
such as the <tt class="docutils literal"><span class="pre">multiprocessing</span></tt> and <tt class="docutils literal"><span class="pre">json</span></tt> modules, but there aren&#8217;t
many new features that aren&#8217;t related to Python 3.0 in some way.</p>
<p>Python 2.6 also sees a number of improvements and bugfixes throughout
the source.  A search through the change logs finds there were 259
patches applied and 612 bugs fixed between Python 2.5 and 2.6.  Both
figures are likely to be underestimates.</p>
<p>This article doesn&#8217;t attempt to provide a complete specification of
the new features, but instead provides a convenient overview.  For
full details, you should refer to the documentation for Python 2.6. If
you want to understand the rationale for the design and
implementation, refer to the PEP for a particular new feature.
Whenever possible, &#8220;What&#8217;s New in Python&#8221; links to the bug/patch item
for each change.</p>
<div class="section" id="python-3-0">
<h2>Python 3.0<a class="headerlink" href="#python-3-0" title="Permalink to this headline">¶</a></h2>
<p>The development cycle for Python versions 2.6 and 3.0 was
synchronized, with the alpha and beta releases for both versions being
made on the same days.  The development of 3.0 has influenced many
features in 2.6.</p>
<p>Python 3.0 is a far-ranging redesign of Python that breaks
compatibility with the 2.x series.  This means that existing Python
code will need some conversion in order to run on Python 3.0.
However, not all the changes in 3.0 necessarily break compatibility.
In cases where new features won&#8217;t cause existing code to break,
they&#8217;ve been backported to 2.6 and are described in this document in
the appropriate place.  Some of the 3.0-derived features are:</p>
<ul class="simple">
<li>A <tt class="docutils literal"><span class="pre">__complex__()</span></tt> method for converting objects to a complex
number.</li>
<li>Alternate syntax for catching exceptions: <tt class="docutils literal"><span class="pre">except</span> <span class="pre">TypeError</span> <span class="pre">as</span>
<span class="pre">exc</span></tt>.</li>
<li>The addition of <tt class="docutils literal"><span class="pre">functools.reduce()</span></tt> as a synonym for the built-in
<tt class="docutils literal"><span class="pre">reduce()</span></tt> function.</li>
</ul>
<p>Python 3.0 adds several new built-in functions and changes the
semantics of some existing built-ins.  Functions that are new in 3.0
such as <tt class="docutils literal"><span class="pre">bin()</span></tt> have simply been added to Python 2.6, but existing
built-ins haven&#8217;t been changed; instead, the <tt class="docutils literal"><span class="pre">future_builtins</span></tt>
module has versions with the new 3.0 semantics.  Code written to be
compatible with 3.0 can do <tt class="docutils literal"><span class="pre">from</span> <span class="pre">future_builtins</span> <span class="pre">import</span> <span class="pre">hex,</span> <span class="pre">map</span></tt> as
necessary.</p>
<p>A new command-line switch, <em>-3</em>, enables warnings about features that
will be removed in Python 3.0.  You can run code with this switch to
see how much work will be necessary to port code to 3.0.  The value of
this switch is available to Python code as the boolean variable
<tt class="docutils literal"><span class="pre">sys.py3kwarning</span></tt>, and to C extension code as
<tt class="docutils literal"><span class="pre">Py_Py3kWarningFlag</span></tt>.</p>
<p>See also:</p>
<blockquote>
The 3xxx series of PEPs, which contains proposals for Python 3.0.
<strong>PEP 3000</strong> describes the development process for Python 3.0.
Start with <strong>PEP 3100</strong> that describes the general goals for Python
3.0, and then explore the higher-numbered PEPS that propose
specific features.</blockquote>
</div>
<div class="section" id="changes-to-the-development-process">
<h2>Changes to the Development Process<a class="headerlink" href="#changes-to-the-development-process" title="Permalink to this headline">¶</a></h2>
<p>While 2.6 was being developed, the Python development process
underwent two significant changes: we switched from SourceForge&#8217;s
issue tracker to a customized Roundup installation, and the
documentation was converted from LaTeX to reStructuredText.</p>
<div class="section" id="new-issue-tracker-roundup">
<h3>New Issue Tracker: Roundup<a class="headerlink" href="#new-issue-tracker-roundup" title="Permalink to this headline">¶</a></h3>
<p>For a long time, the Python developers had been growing increasingly
annoyed by SourceForge&#8217;s bug tracker.  SourceForge&#8217;s hosted solution
doesn&#8217;t permit much customization; for example, it wasn&#8217;t possible to
customize the life cycle of issues.</p>
<p>The infrastructure committee of the Python Software Foundation
therefore posted a call for issue trackers, asking volunteers to set
up different products and import some of the bugs and patches from
SourceForge.  Four different trackers were examined: Jira, Launchpad,
Roundup, and Trac. The committee eventually settled on Jira and
Roundup as the two candidates.  Jira is a commercial product that
offers no-cost hosted instances to free-software projects; Roundup is
an open-source project that requires volunteers to administer it and a
server to host it.</p>
<p>After posting a call for volunteers, a new Roundup installation was
set up at <a class="reference external" href="http://bugs.python.org">http://bugs.python.org</a>.  One installation of Roundup can
host multiple trackers, and this server now also hosts issue trackers
for Jython and for the Python web site.  It will surely find other
uses in the future.  Where possible, this edition of &#8220;What&#8217;s New in
Python&#8221; links to the bug/patch item for each change.</p>
<p>Hosting of the Python bug tracker is kindly provided by Upfront
Systems of Stellenbosch, South Africa.  Martin von Loewis put a lot of
effort into importing existing bugs and patches from SourceForge; his
scripts for this import operation are at
<a class="reference external" href="http://svn.python.org/view/tracker/importer/">http://svn.python.org/view/tracker/importer/</a> and may be useful to
other projects wishing to move from SourceForge to Roundup.</p>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt><a class="reference external" href="http://bugs.python.org">http://bugs.python.org</a></dt>
<dd>The Python bug tracker.</dd>
<dt><a class="reference external" href="http://bugs.jython.org">http://bugs.jython.org</a>:</dt>
<dd>The Jython bug tracker.</dd>
<dt><a class="reference external" href="http://roundup.sourceforge.net/">http://roundup.sourceforge.net/</a></dt>
<dd>Roundup downloads and documentation.</dd>
<dt><a class="reference external" href="http://svn.python.org/view/tracker/importer/">http://svn.python.org/view/tracker/importer/</a></dt>
<dd>Martin von Loewis&#8217;s conversion scripts.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="new-documentation-format-restructuredtext-using-sphinx">
<h3>New Documentation Format: reStructuredText Using Sphinx<a class="headerlink" href="#new-documentation-format-restructuredtext-using-sphinx" title="Permalink to this headline">¶</a></h3>
<p>The Python documentation was written using LaTeX since the project
started around 1989.  In the 1980s and early 1990s, most documentation
was printed out for later study, not viewed online. LaTeX was widely
used because it provided attractive printed output while remaining
straightforward to write once the basic rules of the markup were
learned.</p>
<p>Today LaTeX is still used for writing publications destined for
printing, but the landscape for programming tools has shifted.  We no
longer print out reams of documentation; instead, we browse through it
online and HTML has become the most important format to support.
Unfortunately, converting LaTeX to HTML is fairly complicated and Fred
L. Drake Jr., the long-time Python documentation editor, spent a lot
of time maintaining the conversion process.  Occasionally people would
suggest converting the documentation into SGML and later XML, but
performing a good conversion is a major task and no one ever committed
the time required to finish the job.</p>
<p>During the 2.6 development cycle, Georg Brandl put a lot of effort
into building a new toolchain for processing the documentation.  The
resulting package is called Sphinx, and is available from
<a class="reference external" href="http://sphinx.pocoo.org/">http://sphinx.pocoo.org/</a>.</p>
<p>Sphinx concentrates on HTML output, producing attractively styled and
modern HTML; printed output is still supported through conversion to
LaTeX.  The input format is reStructuredText, a markup syntax
supporting custom extensions and directives that is commonly used in
the Python community.</p>
<p>Sphinx is a standalone package that can be used for writing, and
almost two dozen other projects (listed on the Sphinx web site) have
adopted Sphinx as their documentation tool.</p>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt><em>Documenting Python</em></dt>
<dd>Describes how to write for Python&#8217;s documentation.</dd>
<dt>Sphinx</dt>
<dd>Documentation and code for the Sphinx toolchain.</dd>
<dt>Docutils</dt>
<dd>The underlying reStructuredText parser and toolset.</dd>
</dl>
</blockquote>
</div>
</div>
<div class="section" id="pep-343-the-with-statement">
<h2>PEP 343: The &#8216;with&#8217; statement<a class="headerlink" href="#pep-343-the-with-statement" title="Permalink to this headline">¶</a></h2>
<p>The previous version, Python 2.5, added the &#8216;<tt class="docutils literal"><span class="pre">with</span></tt>&#8216; statement as an
optional feature, to be enabled by a <tt class="docutils literal"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span>
<span class="pre">with_statement</span></tt> directive.  In 2.6 the statement no longer needs to
be specially enabled; this means that <tt class="docutils literal"><span class="pre">with</span></tt> is now always a
keyword.  The rest of this section is a copy of the corresponding
section from the &#8220;What&#8217;s New in Python 2.5&#8221; document; if you&#8217;re
familiar with the &#8216;<tt class="docutils literal"><span class="pre">with</span></tt>&#8216; statement from Python 2.5, you can skip
this section.</p>
<p>The &#8216;<tt class="docutils literal"><span class="pre">with</span></tt>&#8216; statement clarifies code that previously would use
<tt class="docutils literal"><span class="pre">try...finally</span></tt> blocks to ensure that clean-up code is executed.  In
this section, I&#8217;ll discuss the statement as it will commonly be used.
In the next section, I&#8217;ll examine the implementation details and show
how to write objects for use with this statement.</p>
<p>The &#8216;<tt class="docutils literal"><span class="pre">with</span></tt>&#8216; statement is a control-flow structure whose basic
structure is:</p>
<blockquote>
<dl class="docutils">
<dt>with expression [as variable]:</dt>
<dd>with-block</dd>
</dl>
</blockquote>
<p>The expression is evaluated, and it should result in an object that
supports the context management protocol (that is, has <tt class="docutils literal"><span class="pre">__enter__()</span></tt>
and <tt class="docutils literal"><span class="pre">__exit__()</span></tt> methods).</p>
<p>The object&#8217;s <tt class="docutils literal"><span class="pre">__enter__()</span></tt> is called before <em>with-block</em> is executed
and therefore can run set-up code. It also may return a value that is
bound to the name <em>variable</em>, if given.  (Note carefully that
<em>variable</em> is <em>not</em> assigned the result of <em>expression</em>.)</p>
<p>After execution of the <em>with-block</em> is finished, the object&#8217;s
<tt class="docutils literal"><span class="pre">__exit__()</span></tt> method is called, even if the block raised an
exception, and can therefore run clean-up code.</p>
<p>Some standard Python objects now support the context management
protocol and can be used with the &#8216;<tt class="docutils literal"><span class="pre">with</span></tt>&#8216; statement. File objects
are one example:</p>
<blockquote>
<dl class="docutils">
<dt>with open(&#8216;/etc/passwd&#8217;, &#8216;r&#8217;) as f:</dt>
<dd><dl class="first last docutils">
<dt>for line in f:</dt>
<dd>print line
... more processing code ...</dd>
</dl>
</dd>
</dl>
</blockquote>
<p>After this statement has executed, the file object in <em>f</em> will have
been automatically closed, even if the <tt class="docutils literal"><span class="pre">for</span></tt> loop raised an
exception part- way through the block.</p>
<dl class="docutils">
<dt>Note: In this case, <em>f</em> is the same object created by <tt class="docutils literal"><span class="pre">open()</span></tt>, because</dt>
<dd><tt class="docutils literal"><span class="pre">file.__enter__()</span></tt> returns <em>self</em>.</dd>
</dl>
<p>The <tt class="docutils literal"><span class="pre">threading</span></tt> module&#8217;s locks and condition variables  also support
the &#8216;<tt class="docutils literal"><span class="pre">with</span></tt>&#8216; statement:</p>
<blockquote>
<p>lock = threading.Lock()
with lock:</p>
<blockquote>
# Critical section of code
...</blockquote>
</blockquote>
<p>The lock is acquired before the block is executed and always released
once  the block is complete.</p>
<p>The <tt class="docutils literal"><span class="pre">localcontext()</span></tt> function in the <tt class="docutils literal"><span class="pre">decimal</span></tt> module makes it
easy to save and restore the current decimal context, which
encapsulates the desired precision and rounding characteristics for
computations:</p>
<blockquote>
<p>from decimal import Decimal, Context, localcontext</p>
<p># Displays with default precision of 28 digits
v = Decimal(&#8216;578&#8217;)
print v.sqrt()</p>
<dl class="docutils">
<dt>with localcontext(Context(prec=16)):</dt>
<dd># All code in this block uses a precision of 16 digits.
# The original context is restored on exiting the block.
print v.sqrt()</dd>
</dl>
</blockquote>
<div class="section" id="writing-context-managers">
<h3>Writing Context Managers<a class="headerlink" href="#writing-context-managers" title="Permalink to this headline">¶</a></h3>
<p>Under the hood, the &#8216;<tt class="docutils literal"><span class="pre">with</span></tt>&#8216; statement is fairly complicated. Most
people will only use &#8216;<tt class="docutils literal"><span class="pre">with</span></tt>&#8216; in company with existing objects and
don&#8217;t need to know these details, so you can skip the rest of this
section if you like.  Authors of new objects will need to understand
the details of the underlying implementation and should keep reading.</p>
<p>A high-level explanation of the context management protocol is:</p>
<ul class="simple">
<li>The expression is evaluated and should result in an object called a
&#8220;context manager&#8221;.  The context manager must have <tt class="docutils literal"><span class="pre">__enter__()</span></tt>
and <tt class="docutils literal"><span class="pre">__exit__()</span></tt> methods.</li>
<li>The context manager&#8217;s <tt class="docutils literal"><span class="pre">__enter__()</span></tt> method is called.  The value
returned is assigned to <em>VAR</em>.  If no <tt class="docutils literal"><span class="pre">as</span> <span class="pre">VAR</span></tt> clause is present,
the value is simply discarded.</li>
<li>The code in <em>BLOCK</em> is executed.</li>
<li>If <em>BLOCK</em> raises an exception, the <tt class="docutils literal"><span class="pre">__exit__(type,</span> <span class="pre">value,</span>
<span class="pre">traceback)()</span></tt> is called with the exception details, the same values
returned by <tt class="docutils literal"><span class="pre">sys.exc_info()</span></tt>.  The method&#8217;s return value controls
whether the exception is re-raised: any false value re-raises the
exception, and <tt class="xref docutils literal"><span class="pre">True</span></tt> will result in suppressing it.  You&#8217;ll only
rarely want to suppress the exception, because if you do the author
of the code containing the &#8216;<tt class="docutils literal"><span class="pre">with</span></tt>&#8216; statement will never realize
anything went wrong.</li>
<li>If <em>BLOCK</em> didn&#8217;t raise an exception,  the <tt class="docutils literal"><span class="pre">__exit__()</span></tt> method is
still called, but <em>type</em>, <em>value</em>, and <em>traceback</em> are all <tt class="xref docutils literal"><span class="pre">None</span></tt>.</li>
</ul>
<p>Let&#8217;s think through an example.  I won&#8217;t present detailed code but
will only sketch the methods necessary for a database that supports
transactions.</p>
<p>(For people unfamiliar with database terminology: a set of changes to
the database are grouped into a transaction.  Transactions can be
either committed, meaning that all the changes are written into the
database, or rolled back, meaning that the changes are all discarded
and the database is unchanged.  See any database textbook for more
information.)</p>
<p>Let&#8217;s assume there&#8217;s an object representing a database connection. Our
goal will be to let the user write code like this:</p>
<blockquote>
<p>db_connection = DatabaseConnection()
with db_connection as cursor:</p>
<blockquote>
cursor.execute(&#8216;insert into ...&#8217;)
cursor.execute(&#8216;delete from ...&#8217;)
# ... more operations ...</blockquote>
</blockquote>
<p>The transaction should be committed if the code in the block runs
flawlessly or rolled back if there&#8217;s an exception. Here&#8217;s the basic
interface for <tt class="docutils literal"><span class="pre">DatabaseConnection</span></tt> that I&#8217;ll assume:</p>
<blockquote>
<dl class="docutils">
<dt>class DatabaseConnection:</dt>
<dd><p class="first"># Database interface
def cursor(self):</p>
<blockquote>
&#8220;Returns a cursor object and starts a new transaction&#8221;</blockquote>
<dl class="last docutils">
<dt>def commit(self):</dt>
<dd>&#8220;Commits current transaction&#8221;</dd>
<dt>def rollback(self):</dt>
<dd>&#8220;Rolls back current transaction&#8221;</dd>
</dl>
</dd>
</dl>
</blockquote>
<p>The <tt class="docutils literal"><span class="pre">__enter__()</span></tt> method is pretty easy, having only to start a new
transaction.  For this application the resulting cursor object would
be a useful result, so the method will return it.  The user can then
add <tt class="docutils literal"><span class="pre">as</span> <span class="pre">cursor</span></tt> to their &#8216;<tt class="docutils literal"><span class="pre">with</span></tt>&#8216; statement to bind the cursor to
a variable name.</p>
<blockquote>
<dl class="docutils">
<dt>class DatabaseConnection:</dt>
<dd><p class="first">...
def __enter__(self):</p>
<blockquote class="last">
# Code to start a new transaction
cursor = self.cursor()
return cursor</blockquote>
</dd>
</dl>
</blockquote>
<p>The <tt class="docutils literal"><span class="pre">__exit__()</span></tt> method is the most complicated because it&#8217;s where
most of the work has to be done.  The method has to check if an
exception occurred.  If there was no exception, the transaction is
committed.  The transaction is rolled back if there was an exception.</p>
<p>In the code below, execution will just fall off the end of the
function, returning the default value of <tt class="xref docutils literal"><span class="pre">None</span></tt>.  <tt class="xref docutils literal"><span class="pre">None</span></tt> is false,
so the exception will be re-raised automatically.  If you wished, you
could be more explicit and add a <tt class="docutils literal"><span class="pre">return</span></tt> statement at the marked
location.</p>
<blockquote>
<dl class="docutils">
<dt>class DatabaseConnection:</dt>
<dd><p class="first">...
def __exit__(self, type, value, tb):</p>
<blockquote class="last">
<dl class="docutils">
<dt>if tb is None:</dt>
<dd># No exception, so commit
self.commit()</dd>
<dt>else:</dt>
<dd># Exception occurred, so rollback.
self.rollback()
# return False</dd>
</dl>
</blockquote>
</dd>
</dl>
</blockquote>
</div>
<div class="section" id="the-contextlib-module">
<h3>The contextlib module<a class="headerlink" href="#the-contextlib-module" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">contextlib</span></tt> module provides some functions and a decorator that
are useful when writing objects for use with the &#8216;<tt class="docutils literal"><span class="pre">with</span></tt>&#8216; statement.</p>
<p>The decorator is called <tt class="docutils literal"><span class="pre">contextmanager()</span></tt>, and lets you write a
single generator function instead of defining a new class.  The
generator should yield exactly one value.  The code up to the
<tt class="docutils literal"><span class="pre">yield</span></tt> will be executed as the <tt class="docutils literal"><span class="pre">__enter__()</span></tt> method, and the
value yielded will be the method&#8217;s return value that will get bound to
the variable in the &#8216;<tt class="docutils literal"><span class="pre">with</span></tt>&#8216; statement&#8217;s <tt class="docutils literal"><span class="pre">as</span></tt> clause, if any.  The
code after the <tt class="docutils literal"><span class="pre">yield</span></tt> will be executed in the <tt class="docutils literal"><span class="pre">__exit__()</span></tt>
method.  Any exception raised in the block will be raised by the
<tt class="docutils literal"><span class="pre">yield</span></tt> statement.</p>
<p>Using this decorator, our database example from the previous section
could be written as:</p>
<blockquote>
<p>from contextlib import contextmanager</p>
<p>&#64;contextmanager
def db_transaction(connection):</p>
<blockquote>
<p>cursor = connection.cursor()
try:</p>
<blockquote>
yield cursor</blockquote>
<dl class="docutils">
<dt>except:</dt>
<dd>connection.rollback()
raise</dd>
<dt>else:</dt>
<dd>connection.commit()</dd>
</dl>
</blockquote>
<p>db = DatabaseConnection()
with db_transaction(db) as cursor:</p>
<blockquote>
...</blockquote>
</blockquote>
<p>The <tt class="docutils literal"><span class="pre">contextlib</span></tt> module also has a <tt class="docutils literal"><span class="pre">nested(mgr1,</span> <span class="pre">mgr2,</span> <span class="pre">...)()</span></tt>
function that combines a number of context managers so you don&#8217;t need
to write nested &#8216;<tt class="docutils literal"><span class="pre">with</span></tt>&#8216; statements.  In this example, the single
&#8216;<tt class="docutils literal"><span class="pre">with</span></tt>&#8216; statement both starts a database transaction and acquires a
thread lock:</p>
<blockquote>
<p>lock = threading.Lock()
with nested (db_transaction(db), lock) as (cursor, locked):</p>
<blockquote>
...</blockquote>
</blockquote>
<p>Finally, the <tt class="docutils literal"><span class="pre">closing(object)()</span></tt> function returns <em>object</em> so that
it can be bound to a variable, and calls <tt class="docutils literal"><span class="pre">object.close</span></tt> at the end
of the block.</p>
<blockquote>
<p>import urllib, sys
from contextlib import closing</p>
<dl class="docutils">
<dt>with closing(urllib.urlopen(&#8216;<a class="reference external" href="http://www.yahoo.com">http://www.yahoo.com</a>&#8216;)) as f:</dt>
<dd><dl class="first last docutils">
<dt>for line in f:</dt>
<dd>sys.stdout.write(line)</dd>
</dl>
</dd>
</dl>
</blockquote>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt><strong>PEP 343</strong> - The &#8220;with&#8221; statement</dt>
<dd>PEP written by Guido van Rossum and Nick Coghlan; implemented by
Mike Bland, Guido van Rossum, and Neal Norwitz.  The PEP shows
the code generated for a &#8216;<tt class="docutils literal"><span class="pre">with</span></tt>&#8216; statement, which can be
helpful in learning how the statement works.</dd>
</dl>
<p>The documentation  for the <tt class="docutils literal"><span class="pre">contextlib</span></tt> module.</p>
</blockquote>
</div>
</div>
<div class="section" id="pep-366-explicit-relative-imports-from-a-main-module">
<h2>PEP 366: Explicit Relative Imports From a Main Module<a class="headerlink" href="#pep-366-explicit-relative-imports-from-a-main-module" title="Permalink to this headline">¶</a></h2>
<p>Python&#8217;s <em>-m</em> switch allows running a module as a script. When you ran
a module that was located inside a package, relative imports didn&#8217;t
work correctly.</p>
<p>The fix for Python 2.6 adds a <tt class="docutils literal"><span class="pre">__package__</span></tt> attribute to modules.
When this attribute is present, relative imports will be relative to
the value of this attribute instead of the <tt class="docutils literal"><span class="pre">__name__</span></tt> attribute.</p>
<p>PEP 302-style importers can then set <tt class="docutils literal"><span class="pre">__package__</span></tt> as necessary. The
<tt class="docutils literal"><span class="pre">runpy</span></tt> module that implements the <em>-m</em> switch now does this, so
relative imports will now work correctly in scripts running from
inside a package.</p>
</div>
<div class="section" id="pep-370-per-user-site-packages-directory">
<h2>PEP 370: Per-user <tt class="docutils literal"><span class="pre">site-packages</span></tt> Directory<a class="headerlink" href="#pep-370-per-user-site-packages-directory" title="Permalink to this headline">¶</a></h2>
<p>When you run Python, the module search path <tt class="docutils literal"><span class="pre">sys.path</span></tt> usually
includes a directory whose path ends in <tt class="docutils literal"><span class="pre">&quot;site-packages&quot;</span></tt>.  This
directory is intended to hold locally-installed packages available to
all users using a machine or a particular site installation.</p>
<p>Python 2.6 introduces a convention for user-specific site directories.
The directory varies depending on the platform:</p>
<ul class="simple">
<li>Unix and Mac OS X: <tt class="docutils literal"><span class="pre">~/.local/</span></tt></li>
<li>Windows: <tt class="docutils literal"><span class="pre">%APPDATA%/Python</span></tt></li>
</ul>
<p>Within this directory, there will be version-specific subdirectories,
such as <tt class="docutils literal"><span class="pre">lib/python2.6/site-packages</span></tt> on Unix/Mac OS and
<tt class="docutils literal"><span class="pre">Python26/site-packages</span></tt> on Windows.</p>
<p>If you don&#8217;t like the default directory, it can be overridden by an
environment variable.  <strong>PYTHONUSERBASE</strong> sets the root directory used
for all Python versions supporting this feature.  On Windows, the
directory for application-specific data can be changed by setting the
<strong>APPDATA</strong> environment variable.  You can also modify the <tt class="docutils literal"><span class="pre">site.py</span></tt>
file for your Python installation.</p>
<p>The feature can be disabled entirely by running Python with the <em>-s</em>
option or setting the <strong>PYTHONNOUSERSITE</strong> environment variable.</p>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt><strong>PEP 370</strong> - Per-user <tt class="docutils literal"><span class="pre">site-packages</span></tt> Directory</dt>
<dd>PEP written and implemented by Christian Heimes.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="pep-371-the-multiprocessing-package">
<h2>PEP 371: The <tt class="docutils literal"><span class="pre">multiprocessing</span></tt> Package<a class="headerlink" href="#pep-371-the-multiprocessing-package" title="Permalink to this headline">¶</a></h2>
<p>The new <tt class="docutils literal"><span class="pre">multiprocessing</span></tt> package lets Python programs create new
processes that will perform a computation and return a result to the
parent.  The parent and child processes can communicate using queues
and pipes, synchronize their operations using locks and semaphores,
and can share simple arrays of data.</p>
<p>The <tt class="docutils literal"><span class="pre">multiprocessing</span></tt> module started out as an exact emulation of
the <tt class="docutils literal"><span class="pre">threading</span></tt> module using processes instead of threads.  That
goal was discarded along the path to Python 2.6, but the general
approach of the module is still similar.  The fundamental class is the
<tt class="docutils literal"><span class="pre">Process</span></tt>, which is passed a callable object and a collection of
arguments.  The <tt class="docutils literal"><span class="pre">start()</span></tt> method sets the callable running in a
subprocess, after which you can call the <tt class="docutils literal"><span class="pre">is_alive()</span></tt> method to
check whether the subprocess is still running and the <tt class="docutils literal"><span class="pre">join()</span></tt>
method to wait for the process to exit.</p>
<p>Here&#8217;s a simple example where the subprocess will calculate a
factorial.  The function doing the calculation is written strangely so
that it takes significantly longer when the input argument is a
multiple of 4.</p>
<blockquote>
<p>import time
from multiprocessing import Process, Queue</p>
<dl class="docutils">
<dt>def factorial(queue, N):</dt>
<dd><p class="first">&#8220;Compute a factorial.&#8221;
# If N is a multiple of 4, this function will take much longer.
if (N % 4) == 0:</p>
<blockquote>
time.sleep(.05 * N/4)</blockquote>
<p># Calculate the result
fact = 1L
for i in range(1, N+1):</p>
<blockquote>
fact = fact * i</blockquote>
<p class="last"># Put the result on the queue
queue.put(fact)</p>
</dd>
<dt>if __name__ == &#8216;__main__&#8217;:</dt>
<dd><p class="first">queue = Queue()</p>
<p>N = 5</p>
<p>p = Process(target=factorial, args=(queue, N))
p.start()
p.join()</p>
<p class="last">result = queue.get()
print &#8216;Factorial&#8217;, N, &#8216;=&#8217;, result</p>
</dd>
</dl>
</blockquote>
<p>A <tt class="docutils literal"><span class="pre">Queue</span></tt> is used to communicate the input parameter <em>N</em> and the
result.  The <tt class="docutils literal"><span class="pre">Queue</span></tt> object is stored in a global variable. The
child process will use the value of the variable when the child was
created; because it&#8217;s a <tt class="docutils literal"><span class="pre">Queue</span></tt>, parent and child can use the object
to communicate.  (If the parent were to change the value of the global
variable, the child&#8217;s value would be unaffected, and vice versa.)</p>
<p>Two other classes, <tt class="docutils literal"><span class="pre">Pool</span></tt> and <tt class="docutils literal"><span class="pre">Manager</span></tt>, provide higher-level
interfaces.  <tt class="docutils literal"><span class="pre">Pool</span></tt> will create a fixed number of worker processes,
and requests can then be distributed to the workers by calling
<tt class="docutils literal"><span class="pre">apply()</span></tt> or <tt class="docutils literal"><span class="pre">apply_async()</span></tt> to add a single request, and
<tt class="docutils literal"><span class="pre">map()</span></tt> or <tt class="docutils literal"><span class="pre">map_async()</span></tt> to add a number of requests.  The
following code uses a <tt class="docutils literal"><span class="pre">Pool</span></tt> to spread requests across 5 worker
processes and retrieve a list of results:</p>
<blockquote>
<p>from multiprocessing import Pool</p>
<dl class="docutils">
<dt>def factorial(N, dictionary):</dt>
<dd>&#8220;Compute a factorial.&#8221;
...</dd>
</dl>
<p>p = Pool(5)
result = p.map(factorial, range(1, 1000, 10))
for v in result:</p>
<blockquote>
print v</blockquote>
</blockquote>
<p>This produces the following output:</p>
<blockquote>
1
39916800
51090942171709440000
8222838654177922817725562880000000
33452526613163807108170062053440751665152000000000
...</blockquote>
<p>The other high-level interface, the <tt class="docutils literal"><span class="pre">Manager</span></tt> class, creates a
separate server process that can hold master copies of Python data
structures.  Other processes can then access and modify these data
structures using proxy objects.  The following example creates a
shared dictionary by calling the <tt class="docutils literal"><span class="pre">dict()</span></tt> method; the worker
processes then insert values into the dictionary.  (Locking is not
done for you automatically, which doesn&#8217;t matter in this example.
<tt class="docutils literal"><span class="pre">Manager</span></tt>&#8216;s methods also include <tt class="docutils literal"><span class="pre">Lock()</span></tt>, <tt class="docutils literal"><span class="pre">RLock()</span></tt>, and
<tt class="docutils literal"><span class="pre">Semaphore()</span></tt> to create shared locks.)</p>
<blockquote>
<p>import time
from multiprocessing import Pool, Manager</p>
<dl class="docutils">
<dt>def factorial(N, dictionary):</dt>
<dd><p class="first">&#8220;Compute a factorial.&#8221;
# Calculate the result
fact = 1L
for i in range(1, N+1):</p>
<blockquote>
fact = fact * i</blockquote>
<p class="last"># Store result in dictionary
dictionary[N] = fact</p>
</dd>
<dt>if __name__ == &#8216;__main__&#8217;:</dt>
<dd><p class="first">p = Pool(5)
mgr = Manager()
d = mgr.dict()         # Create shared dictionary</p>
<p># Run tasks using the pool
for N in range(1, 1000, 10):</p>
<blockquote class="last">
p.apply_async(factorial, (N, d))</blockquote>
</dd>
</dl>
<p># Mark pool as closed &#8211; no more tasks can be added.
p.close()</p>
<p># Wait for tasks to exit
p.join()</p>
<p># Output results
for k, v in sorted(d.items()):</p>
<blockquote>
print k, v</blockquote>
</blockquote>
<p>This will produce the output:</p>
<blockquote>
1 1
11 39916800
21 51090942171709440000
31 8222838654177922817725562880000000
41 33452526613163807108170062053440751665152000000000
51 15511187532873822802242430164693032110632597200169861120000...</blockquote>
<p>See also:</p>
<blockquote>
<p>The documentation for the <tt class="docutils literal"><span class="pre">multiprocessing</span></tt> module.</p>
<dl class="docutils">
<dt><strong>PEP 371</strong> - Addition of the multiprocessing package</dt>
<dd>PEP written by Jesse Noller and Richard Oudkerk; implemented by
Richard Oudkerk and Jesse Noller.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="pep-3101-advanced-string-formatting">
<h2>PEP 3101: Advanced String Formatting<a class="headerlink" href="#pep-3101-advanced-string-formatting" title="Permalink to this headline">¶</a></h2>
<p>In Python 3.0, the <em>%</em> operator is supplemented by a more powerful
string formatting method, <tt class="docutils literal"><span class="pre">format()</span></tt>.  Support for the
<tt class="docutils literal"><span class="pre">str.format()</span></tt> method has been backported to Python 2.6.</p>
<p>In 2.6, both 8-bit and Unicode strings have a <em>.format()</em> method that
treats the string as a template and takes the arguments to be
formatted. The formatting template uses curly brackets (<em>{</em>, <em>}</em>) as
special characters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Substitute positional argument 0 into the string.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&quot;User ID: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;root&quot;</span><span class="p">)</span>
<span class="go">&#39;User ID: root&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Use the named keyword arguments</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&quot;User ID: {uid}   Last seen: {last_login}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">uid</span><span class="o">=</span><span class="s">&quot;root&quot;</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">last_login</span> <span class="o">=</span> <span class="s">&quot;5 Mar 2008 07:20&quot;</span><span class="p">)</span>
<span class="go">&#39;User ID: root   Last seen: 5 Mar 2008 07:20&#39;</span>
</pre></div>
</div>
<p>Curly brackets can be escaped by doubling them:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="s">&quot;Empty dict: {{}}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">()</span>
<span class="go">&quot;Empty dict: {}&quot;</span>
</pre></div>
</div>
<p>Field names can be integers indicating positional arguments, such as
<tt class="docutils literal"><span class="pre">{0}</span></tt>, <tt class="docutils literal"><span class="pre">{1}</span></tt>, etc. or names of keyword arguments.  You can also
supply compound field names that read attributes or access dictionary
keys:</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&#39;Platform: {0.platform}</span><span class="se">\n</span><span class="s">Python version: {0.version}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="go">Platform: darwin</span>
<span class="go">Python version: 2.6a1+ (trunk:61261M, Mar  5 2008, 20:29:41)</span>
<span class="go">[GCC 4.0.1 (Apple Computer, Inc. build 5367)]&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mimetypes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;Content-type: {0[.mp4]}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mimetypes</span><span class="o">.</span><span class="n">types_map</span><span class="p">)</span>
<span class="go">&#39;Content-type: video/mp4&#39;</span>
</pre></div>
</div>
</blockquote>
<p>Note that when using dictionary-style notation such as <tt class="docutils literal"><span class="pre">[.mp4]</span></tt>, you
don&#8217;t need to put any quotation marks around the string; it will look
up the value using <tt class="docutils literal"><span class="pre">.mp4</span></tt> as the key.  Strings beginning with a
number will be converted to an integer.  You can&#8217;t write more
complicated expressions inside a format string.</p>
<p>So far we&#8217;ve shown how to specify which field to substitute into the
resulting string.  The precise formatting used is also controllable by
adding a colon followed by a format specifier.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Field 0: left justify, pad to 15 characters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Field 1: right justify, pad to 6 characters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmt</span> <span class="o">=</span> <span class="s">&#39;{0:15} ${1:&gt;6}&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&#39;Registration&#39;</span><span class="p">,</span> <span class="mf">35</span><span class="p">)</span>
<span class="go">&#39;Registration    $    35&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&#39;Tutorial&#39;</span><span class="p">,</span> <span class="mf">50</span><span class="p">)</span>
<span class="go">&#39;Tutorial        $    50&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&#39;Banquet&#39;</span><span class="p">,</span> <span class="mf">125</span><span class="p">)</span>
<span class="go">&#39;Banquet         $   125&#39;</span>
</pre></div>
</div>
<p>Format specifiers can reference other fields through nesting:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fmt</span> <span class="o">=</span> <span class="s">&#39;{0:{1}}&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">width</span> <span class="o">=</span> <span class="mf">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&#39;Invoice #1234&#39;</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
<span class="go">&#39;Invoice #1234  &#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">width</span> <span class="o">=</span> <span class="mf">35</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&#39;Invoice #1234&#39;</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
<span class="go">&#39;Invoice #1234                      &#39;</span>
</pre></div>
</div>
<p>The alignment of a field within the desired width can be specified:</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="72%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Character</th>
<th class="head">Effect</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>&lt; (default)</td>
<td>Left-align</td>
</tr>
<tr><td>&gt;</td>
<td>Right-align</td>
</tr>
<tr><td>^</td>
<td>Center</td>
</tr>
<tr><td>=</td>
<td>(For numeric types only) Pad after the sign.</td>
</tr>
</tbody>
</table>
<p>Format specifiers can also include a presentation type, which controls
how the value is formatted.  For example, floating-point numbers can
be formatted as a general number or in exponential notation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;{0:g}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">3.75</span><span class="p">)</span>
<span class="go">&#39;3.75&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;{0:e}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">3.75</span><span class="p">)</span>
<span class="go">&#39;3.750000e+00&#39;</span>
</pre></div>
</div>
<p>A variety of presentation types are available.  Consult the 2.6
documentation for a <em>complete list</em>; here&#8217;s a sample:</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="91%" />
</colgroup>
<tbody valign="top">
<tr><td><tt class="docutils literal"><span class="pre">b</span></tt></td>
<td>Binary. Outputs the number in base 2.</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">c</span></tt></td>
<td>Character. Converts the integer to the corresponding Unicode character
before printing.</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">d</span></tt></td>
<td>Decimal Integer. Outputs the number in base 10.</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">o</span></tt></td>
<td>Octal format. Outputs the number in base 8.</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">x</span></tt></td>
<td>Hex format. Outputs the number in base 16, using lower-case letters for
the digits above 9.</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">e</span></tt></td>
<td>Exponent notation. Prints the number in scientific notation using the
letter &#8216;e&#8217; to indicate the exponent.</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">g</span></tt></td>
<td>General format. This prints the number as a fixed-point number, unless
the number is too large, in which case it switches to &#8216;e&#8217; exponent
notation.</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">n</span></tt></td>
<td>Number. This is the same as &#8216;g&#8217; (for floats) or &#8216;d&#8217; (for integers),
except that it uses the current locale setting to insert the appropriate
number separator characters.</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">%</span></tt></td>
<td>Percentage. Multiplies the number by 100 and displays in fixed (&#8216;f&#8217;)
format, followed by a percent sign.</td>
</tr>
</tbody>
</table>
<p>Classes and types can define a <tt class="docutils literal"><span class="pre">__format__()</span></tt> method to control how
they&#8217;re formatted.  It receives a single argument, the format
specifier:</p>
<blockquote>
<dl class="docutils">
<dt>def __format__(self, format_spec):</dt>
<dd><dl class="first last docutils">
<dt>if isinstance(format_spec, unicode):</dt>
<dd>return unicode(str(self))</dd>
<dt>else:</dt>
<dd>return str(self)</dd>
</dl>
</dd>
</dl>
</blockquote>
<p>There&#8217;s also a <tt class="docutils literal"><span class="pre">format()</span></tt> built-in that will format a single value.
It calls the type&#8217;s <tt class="docutils literal"><span class="pre">__format__()</span></tt> method with the provided
specifier:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">format</span><span class="p">(</span><span class="mf">75.6564</span><span class="p">,</span> <span class="s">&#39;.2f&#39;</span><span class="p">)</span>
<span class="go">&#39;75.66&#39;</span>
</pre></div>
</div>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt><em>Format String Syntax</em></dt>
<dd>The reference documentation for format fields.</dd>
<dt><strong>PEP 3101</strong> - Advanced String Formatting</dt>
<dd>PEP written by Talin. Implemented by Eric Smith.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="pep-3105-print-as-a-function">
<h2>PEP 3105: <tt class="docutils literal"><span class="pre">print</span></tt> As a Function<a class="headerlink" href="#pep-3105-print-as-a-function" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">print</span></tt> statement becomes the <tt class="docutils literal"><span class="pre">print()</span></tt> function in Python
3.0. Making <tt class="docutils literal"><span class="pre">print()</span></tt> a function makes it possible to replace the
function by doing <tt class="docutils literal"><span class="pre">def</span> <span class="pre">print(...)</span></tt> or importing a new function from
somewhere else.</p>
<p>Python 2.6 has a <tt class="docutils literal"><span class="pre">__future__</span></tt> import that removes <tt class="docutils literal"><span class="pre">print</span></tt> as
language syntax, letting you use the functional form instead.  For
example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;# of entries&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dictionary</span><span class="p">),</span> <span class="nb">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</pre></div>
</div>
<p>The signature of the new function is:</p>
<blockquote>
def print(<a href="#id1"><span class="problematic" id="id2">*</span></a>args, sep=&#8217; &#8216;, end=&#8217;n&#8217;, file=None)</blockquote>
<p>The parameters are:</p>
<blockquote>
<ul class="simple">
<li><em>args</em>: positional arguments whose values will be printed out.</li>
<li><em>sep</em>: the separator, which will be printed between arguments.</li>
<li><em>end</em>: the ending text, which will be printed after all of the
arguments have been output.</li>
<li><em>file</em>: the file object to which the output will be sent.</li>
</ul>
</blockquote>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt><strong>PEP 3105</strong> - Make print a function</dt>
<dd>PEP written by Georg Brandl.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="pep-3110-exception-handling-changes">
<h2>PEP 3110: Exception-Handling Changes<a class="headerlink" href="#pep-3110-exception-handling-changes" title="Permalink to this headline">¶</a></h2>
<p>One error that Python programmers occasionally make is writing the
following code:</p>
<blockquote>
<dl class="docutils">
<dt>try:</dt>
<dd>...</dd>
<dt>except TypeError, ValueError:  # Wrong!</dt>
<dd>...</dd>
</dl>
</blockquote>
<p>The author is probably trying to catch both <tt class="docutils literal"><span class="pre">TypeError</span></tt> and
<tt class="docutils literal"><span class="pre">ValueError</span></tt> exceptions, but this code actually does something
different: it will catch <tt class="docutils literal"><span class="pre">TypeError</span></tt> and bind the resulting
exception object to the local name <tt class="docutils literal"><span class="pre">&quot;ValueError&quot;</span></tt>.  The
<tt class="docutils literal"><span class="pre">ValueError</span></tt> exception will not be caught at all.  The correct code
specifies a tuple of exceptions:</p>
<blockquote>
<dl class="docutils">
<dt>try:</dt>
<dd>...</dd>
<dt>except (TypeError, ValueError):</dt>
<dd>...</dd>
</dl>
</blockquote>
<p>This error happens because the use of the comma here is ambiguous:
does it indicate two different nodes in the parse tree, or a single
node that&#8217;s a tuple?</p>
<p>Python 3.0 makes this unambiguous by replacing the comma with the word
&#8220;as&#8221;.  To catch an exception and store the exception object in the
variable <tt class="docutils literal"><span class="pre">exc</span></tt>, you must write:</p>
<blockquote>
<dl class="docutils">
<dt>try:</dt>
<dd>...</dd>
<dt>except TypeError as exc:</dt>
<dd>...</dd>
</dl>
</blockquote>
<p>Python 3.0 will only support the use of &#8220;as&#8221;, and therefore interprets
the first example as catching two different exceptions.  Python 2.6
supports both the comma and &#8220;as&#8221;, so existing code will continue to
work.  We therefore suggest using &#8220;as&#8221; when writing new Python code
that will only be executed with 2.6.</p>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt><strong>PEP 3110</strong> - Catching Exceptions in Python 3000</dt>
<dd>PEP written and implemented by Collin Winter.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="pep-3112-byte-literals">
<h2>PEP 3112: Byte Literals<a class="headerlink" href="#pep-3112-byte-literals" title="Permalink to this headline">¶</a></h2>
<p>Python 3.0 adopts Unicode as the language&#8217;s fundamental string type
and denotes 8-bit literals differently, either as <tt class="docutils literal"><span class="pre">b'string'</span></tt> or
using a <tt class="docutils literal"><span class="pre">bytes</span></tt> constructor.  For future compatibility, Python 2.6
adds <tt class="docutils literal"><span class="pre">bytes</span></tt> as a synonym for the <tt class="docutils literal"><span class="pre">str</span></tt> type, and it also supports
the <tt class="docutils literal"><span class="pre">b''</span></tt> notation.</p>
<p>The 2.6 <tt class="docutils literal"><span class="pre">str</span></tt> differs from 3.0&#8217;s <tt class="docutils literal"><span class="pre">bytes</span></tt> type in various ways;
most notably, the constructor is completely different.  In 3.0,
<tt class="docutils literal"><span class="pre">bytes([65,</span> <span class="pre">66,</span> <span class="pre">67])</span></tt> is 3 elements long, containing the bytes
representing <tt class="docutils literal"><span class="pre">ABC</span></tt>; in 2.6, <tt class="docutils literal"><span class="pre">bytes([65,</span> <span class="pre">66,</span> <span class="pre">67])</span></tt> returns the
12-byte string representing the <tt class="docutils literal"><span class="pre">str()</span></tt> of the list.</p>
<p>The primary use of <tt class="docutils literal"><span class="pre">bytes</span></tt> in 2.6 will be to write tests of object
type such as <tt class="docutils literal"><span class="pre">isinstance(x,</span> <span class="pre">bytes)</span></tt>.  This will help the 2to3
converter, which can&#8217;t tell whether 2.x code intends strings to
contain either characters or 8-bit bytes; you can now use either
<tt class="docutils literal"><span class="pre">bytes</span></tt> or <tt class="docutils literal"><span class="pre">str</span></tt> to represent your intention exactly, and the
resulting code will also be correct in Python 3.0.</p>
<p>There&#8217;s also a <tt class="docutils literal"><span class="pre">__future__</span></tt> import that causes all string literals
to become Unicode strings.  This means that <tt class="docutils literal"><span class="pre">\u</span></tt> escape sequences
can be used to include Unicode characters:</p>
<blockquote>
<p>from __future__ import unicode_literals</p>
<dl class="docutils">
<dt>s = (&#8216;u751fu3080u304eu3000u751fu3054&#8217;</dt>
<dd>&#8216;u3081u3000u751fu305fu307eu3054&#8217;)</dd>
</dl>
<p>print len(s)               # 12 Unicode characters</p>
</blockquote>
<p>At the C level, Python 3.0 will rename the existing 8-bit string type,
called <tt class="docutils literal"><span class="pre">PyStringObject</span></tt> in Python 2.x, to <tt class="docutils literal"><span class="pre">PyBytesObject</span></tt>.  Python
2.6 uses <tt class="docutils literal"><span class="pre">#define</span></tt> to support using the names <tt class="docutils literal"><span class="pre">PyBytesObject()</span></tt>,
<tt class="docutils literal"><span class="pre">PyBytes_Check()</span></tt>, <tt class="docutils literal"><span class="pre">PyBytes_FromStringAndSize()</span></tt>, and all the
other functions and macros used with strings.</p>
<p>Instances of the <tt class="docutils literal"><span class="pre">bytes</span></tt> type are immutable just as strings are.  A
new <tt class="docutils literal"><span class="pre">bytearray</span></tt> type stores a mutable sequence of bytes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">bytearray</span><span class="p">([</span><span class="mf">65</span><span class="p">,</span> <span class="mf">66</span><span class="p">,</span> <span class="mf">67</span><span class="p">])</span>
<span class="go">bytearray(b&#39;ABC&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">bytearray</span><span class="p">(</span><span class="s">u&#39;</span><span class="se">\u21ef\u3244</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">bytearray(b&#39;\xe2\x87\xaf\xe3\x89\x84&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\xe3</span><span class="s">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">bytearray(b&#39;\xe3\x87\xaf\xe3\x89\x84&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">unicode</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
<span class="go">u&#39;\u31ef \u3244&#39;</span>
</pre></div>
</div>
<p>Byte arrays support most of the methods of string types, such as
<tt class="docutils literal"><span class="pre">startswith()</span></tt>/<tt class="docutils literal"><span class="pre">endswith()</span></tt>, <tt class="docutils literal"><span class="pre">find()</span></tt>/<tt class="docutils literal"><span class="pre">rfind()</span></tt>, and some of
the methods of lists, such as <tt class="docutils literal"><span class="pre">append()</span></tt>, <tt class="docutils literal"><span class="pre">pop()</span></tt>,  and
<tt class="docutils literal"><span class="pre">reverse()</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">bytearray</span><span class="p">(</span><span class="s">&#39;ABC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">bytearray(b&#39;ABCde&#39;)</span>
</pre></div>
</div>
<p>There&#8217;s also a corresponding C API, with <tt class="docutils literal"><span class="pre">PyByteArray_FromObject()</span></tt>,
<tt class="docutils literal"><span class="pre">PyByteArray_FromStringAndSize()</span></tt>, and various other functions.</p>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt><strong>PEP 3112</strong> - Bytes literals in Python 3000</dt>
<dd>PEP written by Jason Orendorff; backported to 2.6 by Christian
Heimes.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="pep-3116-new-i-o-library">
<h2>PEP 3116: New I/O Library<a class="headerlink" href="#pep-3116-new-i-o-library" title="Permalink to this headline">¶</a></h2>
<p>Python&#8217;s built-in file objects support a number of methods, but file-
like objects don&#8217;t necessarily support all of them.  Objects that
imitate files usually support <tt class="docutils literal"><span class="pre">read()</span></tt> and <tt class="docutils literal"><span class="pre">write()</span></tt>, but they may
not support <tt class="docutils literal"><span class="pre">readline()</span></tt>, for example.  Python 3.0 introduces a
layered I/O library in the <tt class="docutils literal"><span class="pre">io</span></tt> module that separates buffering and
text-handling features from the fundamental read and write operations.</p>
<p>There are three levels of abstract base classes provided by the <tt class="docutils literal"><span class="pre">io</span></tt>
module:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">RawIOBase</span></tt> defines raw I/O operations: <tt class="docutils literal"><span class="pre">read()</span></tt>,
<tt class="docutils literal"><span class="pre">readinto()</span></tt>, <tt class="docutils literal"><span class="pre">write()</span></tt>, <tt class="docutils literal"><span class="pre">seek()</span></tt>, <tt class="docutils literal"><span class="pre">tell()</span></tt>, <tt class="docutils literal"><span class="pre">truncate()</span></tt>,
and <tt class="docutils literal"><span class="pre">close()</span></tt>. Most of the methods of this class will often map to
a single system call. There are also <tt class="docutils literal"><span class="pre">readable()</span></tt>, <tt class="docutils literal"><span class="pre">writable()</span></tt>,
and <tt class="docutils literal"><span class="pre">seekable()</span></tt> methods for determining what operations a given
object will allow.</p>
<p>Python 3.0 has concrete implementations of this class for files and
sockets, but Python 2.6 hasn&#8217;t restructured its file and socket
objects in this way.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">BufferedIOBase</span></tt> is an abstract base class that buffers data in
memory to reduce the number of system calls used, making I/O
processing more efficient. It supports all of the methods of
<tt class="docutils literal"><span class="pre">RawIOBase</span></tt>, and adds a <tt class="docutils literal"><span class="pre">raw</span></tt> attribute holding the underlying
raw object.</p>
<p>There are five concrete classes implementing this ABC.
<tt class="docutils literal"><span class="pre">BufferedWriter</span></tt> and <tt class="docutils literal"><span class="pre">BufferedReader</span></tt> are for objects that
support write-only or read-only usage that have a <tt class="docutils literal"><span class="pre">seek()</span></tt> method
for random access.  <tt class="docutils literal"><span class="pre">BufferedRandom</span></tt> objects support read and
write access upon the same underlying stream, and <tt class="docutils literal"><span class="pre">BufferedRWPair</span></tt>
is for objects such as TTYs that have both read and write operations
acting upon unconnected streams of data. The <tt class="docutils literal"><span class="pre">BytesIO</span></tt> class
supports reading, writing, and seeking over an in-memory buffer.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">TextIOBase</span></tt>: Provides functions for reading and writing strings
(remember, strings will be Unicode in Python 3.0), and supporting
universal newlines.  <tt class="docutils literal"><span class="pre">TextIOBase</span></tt> defines the <tt class="docutils literal"><span class="pre">readline()</span></tt>
method and supports iteration upon objects.</p>
<p>There are two concrete implementations.  <tt class="docutils literal"><span class="pre">TextIOWrapper</span></tt> wraps a
buffered I/O object, supporting all of the methods for text I/O and
adding a <tt class="docutils literal"><span class="pre">buffer</span></tt> attribute for access to the underlying object.
<tt class="docutils literal"><span class="pre">StringIO</span></tt> simply buffers everything in memory without ever
writing anything to disk.</p>
<p>(In Python 2.6, <tt class="docutils literal"><span class="pre">io.StringIO</span></tt> is implemented in pure Python, so
it&#8217;s pretty slow.   You should therefore stick with the existing
<tt class="docutils literal"><span class="pre">StringIO</span></tt> module or <tt class="docutils literal"><span class="pre">cStringIO</span></tt> for now.  At some point Python
3.0&#8217;s <tt class="docutils literal"><span class="pre">io</span></tt> module will be rewritten into C for speed, and perhaps
the C implementation will be  backported to the 2.x releases.)</p>
</li>
</ul>
<p>In Python 2.6, the underlying implementations haven&#8217;t been
restructured to build on top of the <tt class="docutils literal"><span class="pre">io</span></tt> module&#8217;s classes.  The
module is being provided to make it easier to write code that&#8217;s
forward-compatible with 3.0, and to save developers the effort of
writing their own implementations of buffering and text I/O.</p>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt><strong>PEP 3116</strong> - New I/O</dt>
<dd>PEP written by Daniel Stutzbach, Mike Verdone, and Guido van
Rossum. Code by Guido van Rossum, Georg Brandl, Walter Doerwald,
Jeremy Hylton, Martin von Loewis, Tony Lownds, and others.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="pep-3118-revised-buffer-protocol">
<h2>PEP 3118: Revised Buffer Protocol<a class="headerlink" href="#pep-3118-revised-buffer-protocol" title="Permalink to this headline">¶</a></h2>
<p>The buffer protocol is a C-level API that lets Python types exchange
pointers into their internal representations.  A memory-mapped file
can be viewed as a buffer of characters, for example, and this lets
another module such as <tt class="docutils literal"><span class="pre">re</span></tt> treat memory-mapped files as a string of
characters to be searched.</p>
<p>The primary users of the buffer protocol are numeric-processing
packages such as NumPy, which expose the internal representation of
arrays so that callers can write data directly into an array instead
of going through a slower API.  This PEP updates the buffer protocol
in light of experience from NumPy development, adding a number of new
features such as indicating the shape of an array or locking a memory
region.</p>
<p>The most important new C API function is <tt class="docutils literal"><span class="pre">PyObject_GetBuffer(PyObject</span>
<span class="pre">*obj,</span> <span class="pre">Py_buffer</span> <span class="pre">*view,</span> <span class="pre">int</span> <span class="pre">flags)</span></tt>, which takes an object and a set
of flags, and fills in the <tt class="docutils literal"><span class="pre">Py_buffer</span></tt> structure with information
about the object&#8217;s memory representation.  Objects can use this
operation to lock memory in place while an external caller could be
modifying the contents, so there&#8217;s a corresponding
<tt class="docutils literal"><span class="pre">PyBuffer_Release(Py_buffer</span> <span class="pre">*view)</span></tt> to indicate that the external
caller is done.</p>
<p>The <em>flags</em> argument to <tt class="docutils literal"><span class="pre">PyObject_GetBuffer()</span></tt> specifies constraints
upon the memory returned.  Some examples are:</p>
<blockquote>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">PyBUF_WRITABLE</span></tt> indicates that the memory must be writable.</li>
<li><tt class="docutils literal"><span class="pre">PyBUF_LOCK</span></tt> requests a read-only or exclusive lock on the
memory.</li>
<li><tt class="docutils literal"><span class="pre">PyBUF_C_CONTIGUOUS</span></tt> and <tt class="docutils literal"><span class="pre">PyBUF_F_CONTIGUOUS</span></tt> requests a
C-contiguous (last dimension varies the fastest) or Fortran-
contiguous (first dimension varies the fastest) array layout.</li>
</ul>
</blockquote>
<p>Two new argument codes for <tt class="docutils literal"><span class="pre">PyArg_ParseTuple()</span></tt>, <tt class="docutils literal"><span class="pre">s*</span></tt> and <tt class="docutils literal"><span class="pre">z*</span></tt>,
return locked buffer objects for a parameter.</p>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt><strong>PEP 3118</strong> - Revising the buffer protocol</dt>
<dd>PEP written by Travis Oliphant and Carl Banks; implemented by
Travis Oliphant.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="pep-3119-abstract-base-classes">
<h2>PEP 3119: Abstract Base Classes<a class="headerlink" href="#pep-3119-abstract-base-classes" title="Permalink to this headline">¶</a></h2>
<p>Some object-oriented languages such as Java support interfaces,
declaring that a class has a given set of methods or supports a given
access protocol.  Abstract Base Classes (or ABCs) are an equivalent
feature for Python. The ABC support consists of an <tt class="docutils literal"><span class="pre">abc</span></tt> module
containing a metaclass called <tt class="docutils literal"><span class="pre">ABCMeta</span></tt>, special handling of this
metaclass by the <tt class="docutils literal"><span class="pre">isinstance()</span></tt> and <tt class="docutils literal"><span class="pre">issubclass()</span></tt> built-ins, and
a collection of basic ABCs that the Python developers think will be
widely useful.  Future versions of Python will probably add more ABCs.</p>
<p>Let&#8217;s say you have a particular class and wish to know whether it
supports dictionary-style access.  The phrase &#8220;dictionary-style&#8221; is
vague, however. It probably means that accessing items with <tt class="docutils literal"><span class="pre">obj[1]</span></tt>
works. Does it imply that setting items with <tt class="docutils literal"><span class="pre">obj[2]</span> <span class="pre">=</span> <span class="pre">value</span></tt> works?
Or that the object will have <tt class="docutils literal"><span class="pre">keys()</span></tt>, <tt class="docutils literal"><span class="pre">values()</span></tt>, and <tt class="docutils literal"><span class="pre">items()</span></tt>
methods?  What about the iterative variants  such as <tt class="docutils literal"><span class="pre">iterkeys()</span></tt>?
<tt class="docutils literal"><span class="pre">copy()</span></tt> and <tt class="docutils literal"><span class="pre">update()</span></tt>?  Iterating over the object with
<tt class="docutils literal"><span class="pre">iter()</span></tt>?</p>
<p>The Python 2.6 <tt class="docutils literal"><span class="pre">collections</span></tt> module includes a number of different
ABCs that represent these distinctions.  <tt class="docutils literal"><span class="pre">Iterable</span></tt> indicates that a
class defines <tt class="docutils literal"><span class="pre">__iter__()</span></tt>, and <tt class="docutils literal"><span class="pre">Container</span></tt> means the class
defines a <tt class="docutils literal"><span class="pre">__contains__()</span></tt> method and therefore supports <tt class="docutils literal"><span class="pre">x</span> <span class="pre">in</span> <span class="pre">y</span></tt>
expressions.  The basic dictionary interface of getting items, setting
items, and <tt class="docutils literal"><span class="pre">keys()</span></tt>, <tt class="docutils literal"><span class="pre">values()</span></tt>, and <tt class="docutils literal"><span class="pre">items()</span></tt>, is defined by
the <tt class="docutils literal"><span class="pre">MutableMapping</span></tt> ABC.</p>
<p>You can derive your own classes from a particular ABC to indicate they
support that ABC&#8217;s interface:</p>
<blockquote>
<p>import collections</p>
<dl class="docutils">
<dt>class Storage(collections.MutableMapping):</dt>
<dd>...</dd>
</dl>
</blockquote>
<p>Alternatively, you could write the class without deriving from the
desired ABC and instead register the class by calling the ABC&#8217;s
<tt class="docutils literal"><span class="pre">register()</span></tt> method:</p>
<blockquote>
<p>import collections</p>
<dl class="docutils">
<dt>class Storage:</dt>
<dd>...</dd>
</dl>
<p>collections.MutableMapping.register(Storage)</p>
</blockquote>
<p>For classes that you write, deriving from the ABC is probably clearer.
The <tt class="docutils literal"><span class="pre">register()</span></tt>  method is useful when you&#8217;ve written a new ABC
that can describe an existing type or class, or if you want to declare
that some third-party class implements an ABC. For example, if you
defined a <tt class="docutils literal"><span class="pre">PrintableType</span></tt> ABC, it&#8217;s legal to do:</p>
<blockquote>
# Register Python&#8217;s types
PrintableType.register(int)
PrintableType.register(float)
PrintableType.register(str)</blockquote>
<p>Classes should obey the semantics specified by an ABC, but Python
can&#8217;t check this; it&#8217;s up to the class author to understand the ABC&#8217;s
requirements and to implement the code accordingly.</p>
<p>To check whether an object supports a particular interface, you can
now write:</p>
<blockquote>
<dl class="docutils">
<dt>def func(d):</dt>
<dd><dl class="first last docutils">
<dt>if not isinstance(d, collections.MutableMapping):</dt>
<dd>raise ValueError(&#8220;Mapping object expected, not %r&#8221; % d)</dd>
</dl>
</dd>
</dl>
</blockquote>
<p>Don&#8217;t feel that you must now begin writing lots of checks as in the
above example.  Python has a strong tradition of duck-typing, where
explicit type-checking is never done and code simply calls methods on
an object, trusting that those methods will be there and raising an
exception if they aren&#8217;t.  Be judicious in checking for ABCs and only
do it where it&#8217;s absolutely necessary.</p>
<p>You can write your own ABCs by using <tt class="docutils literal"><span class="pre">abc.ABCMeta</span></tt> as the metaclass
in a class definition:</p>
<blockquote>
<p>from abc import ABCMeta, abstractmethod</p>
<dl class="docutils">
<dt>class Drawable():</dt>
<dd><p class="first">__metaclass__ = ABCMeta</p>
<p>&#64;abstractmethod
def draw(self, x, y, scale=1.0):</p>
<blockquote>
pass</blockquote>
<dl class="last docutils">
<dt>def draw_doubled(self, x, y):</dt>
<dd>self.draw(x, y, scale=2.0)</dd>
</dl>
</dd>
<dt>class Square(Drawable):</dt>
<dd><dl class="first last docutils">
<dt>def draw(self, x, y, scale):</dt>
<dd>...</dd>
</dl>
</dd>
</dl>
</blockquote>
<p>In the <tt class="docutils literal"><span class="pre">Drawable</span></tt> ABC above, the <tt class="docutils literal"><span class="pre">draw_doubled()</span></tt> method renders
the object at twice its size and can be implemented in terms of other
methods described in <tt class="docutils literal"><span class="pre">Drawable</span></tt>.  Classes implementing this ABC
therefore don&#8217;t need to provide their own implementation of
<tt class="docutils literal"><span class="pre">draw_doubled()</span></tt>, though they can do so.  An implementation of
<tt class="docutils literal"><span class="pre">draw()</span></tt> is necessary, though; the ABC can&#8217;t provide a useful
generic implementation.</p>
<p>You can apply the <tt class="docutils literal"><span class="pre">&#64;abstractmethod</span></tt> decorator to methods such as
<tt class="docutils literal"><span class="pre">draw()</span></tt> that must be implemented; Python will then raise an
exception for classes that don&#8217;t define the method. Note that the
exception is only raised when you actually try to create an instance
of a subclass lacking the method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Circle</span><span class="p">(</span><span class="n">Drawable</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n-Identifier">&lt;module&gt;</span>
<span class="nc">TypeError</span>: <span class="n-Identifier">Can&#39;t instantiate abstract class Circle with abstract methods draw</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Abstract data attributes can be declared using the
<tt class="docutils literal"><span class="pre">&#64;abstractproperty</span></tt> decorator:</p>
<blockquote>
<p>from abc import abstractproperty
...</p>
<p>&#64;abstractproperty
def readonly(self):</p>
<blockquote>
return self._x</blockquote>
</blockquote>
<p>Subclasses must then define a <tt class="docutils literal"><span class="pre">readonly()</span></tt> property.</p>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt><strong>PEP 3119</strong> - Introducing Abstract Base Classes</dt>
<dd>PEP written by Guido van Rossum and Talin. Implemented by Guido
van Rossum. Backported to 2.6 by Benjamin Aranguren, with Alex
Martelli.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="pep-3127-integer-literal-support-and-syntax">
<h2>PEP 3127: Integer Literal Support and Syntax<a class="headerlink" href="#pep-3127-integer-literal-support-and-syntax" title="Permalink to this headline">¶</a></h2>
<p>Python 3.0 changes the syntax for octal (base-8) integer literals,
prefixing them with &#8220;0o&#8221; or &#8220;0O&#8221; instead of a leading zero, and adds
support for binary (base-2) integer literals, signalled by a &#8220;0b&#8221; or
&#8220;0B&#8221; prefix.</p>
<p>Python 2.6 doesn&#8217;t drop support for a leading 0 signalling an octal
number, but it does add support for &#8220;0o&#8221; and &#8220;0b&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="mf">0</span><span class="n">o21</span><span class="p">,</span> <span class="mf">2</span><span class="o">*</span><span class="mf">8</span> <span class="o">+</span> <span class="mf">1</span>
<span class="go">(17, 17)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">0</span><span class="n">b101111</span>
<span class="go">47</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">oct()</span></tt> built-in still returns numbers prefixed with a leading
zero, and a new <tt class="docutils literal"><span class="pre">bin()</span></tt> built-in returns the binary representation
for a number:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">oct</span><span class="p">(</span><span class="mf">42</span><span class="p">)</span>
<span class="go">&#39;052&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">future_builtins</span><span class="o">.</span><span class="n">oct</span><span class="p">(</span><span class="mf">42</span><span class="p">)</span>
<span class="go">&#39;0o52&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bin</span><span class="p">(</span><span class="mf">173</span><span class="p">)</span>
<span class="go">&#39;0b10101101&#39;</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">int()</span></tt> and <tt class="docutils literal"><span class="pre">long()</span></tt> built-ins will now accept the &#8220;0o&#8221; and
&#8220;0b&#8221; prefixes when base-8 or base-2 are requested, or when the <em>base</em>
argument is zero (signalling that the base used should be determined
from the string):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span> <span class="p">(</span><span class="s">&#39;0o52&#39;</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span>
<span class="go">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="p">(</span><span class="s">&#39;1101&#39;</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span>
<span class="go">13</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="p">(</span><span class="s">&#39;0b1101&#39;</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span>
<span class="go">13</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="p">(</span><span class="s">&#39;0b1101&#39;</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span>
<span class="go">13</span>
</pre></div>
</div>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt><strong>PEP 3127</strong> - Integer Literal Support and Syntax</dt>
<dd>PEP written by Patrick Maupin; backported to 2.6 by Eric Smith.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="pep-3129-class-decorators">
<h2>PEP 3129: Class Decorators<a class="headerlink" href="#pep-3129-class-decorators" title="Permalink to this headline">¶</a></h2>
<p>Decorators have been extended from functions to classes.  It&#8217;s now
legal to write:</p>
<blockquote>
<p>&#64;foo
&#64;bar
class A:</p>
<blockquote>
pass</blockquote>
</blockquote>
<p>This is equivalent to:</p>
<blockquote>
<dl class="docutils">
<dt>class A:</dt>
<dd>pass</dd>
</dl>
<p>A = foo(bar(A))</p>
</blockquote>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt><strong>PEP 3129</strong> - Class Decorators</dt>
<dd>PEP written by Collin Winter.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="pep-3141-a-type-hierarchy-for-numbers">
<h2>PEP 3141: A Type Hierarchy for Numbers<a class="headerlink" href="#pep-3141-a-type-hierarchy-for-numbers" title="Permalink to this headline">¶</a></h2>
<p>Python 3.0 adds several abstract base classes for numeric types
inspired by Scheme&#8217;s numeric tower.  These classes were backported to
2.6 as the <tt class="docutils literal"><span class="pre">numbers</span></tt> module.</p>
<p>The most general ABC is <tt class="docutils literal"><span class="pre">Number</span></tt>.  It defines no operations at all,
and only exists to allow checking if an object is a number by doing
<tt class="docutils literal"><span class="pre">isinstance(obj,</span> <span class="pre">Number)</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">Complex</span></tt> is a subclass of <tt class="docutils literal"><span class="pre">Number</span></tt>.  Complex numbers can undergo
the basic operations of addition, subtraction, multiplication,
division, and exponentiation, and you can retrieve the real and
imaginary parts and obtain a number&#8217;s conjugate.  Python&#8217;s built-in
complex type is an implementation of <tt class="docutils literal"><span class="pre">Complex</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">Real</span></tt> further derives from <tt class="docutils literal"><span class="pre">Complex</span></tt>, and adds operations that
only work on real numbers: <tt class="docutils literal"><span class="pre">floor()</span></tt>, <tt class="docutils literal"><span class="pre">trunc()</span></tt>, rounding, taking
the remainder mod N, floor division, and comparisons.</p>
<p><tt class="docutils literal"><span class="pre">Rational</span></tt> numbers derive from <tt class="docutils literal"><span class="pre">Real</span></tt>, have <tt class="docutils literal"><span class="pre">numerator</span></tt> and
<tt class="docutils literal"><span class="pre">denominator</span></tt> properties, and can be converted to floats.  Python
2.6 adds a simple rational-number class, <tt class="docutils literal"><span class="pre">Fraction</span></tt>, in the
<tt class="docutils literal"><span class="pre">fractions</span></tt> module.  (It&#8217;s called <tt class="docutils literal"><span class="pre">Fraction</span></tt> instead of
<tt class="docutils literal"><span class="pre">Rational</span></tt> to avoid a name clash with <tt class="docutils literal"><span class="pre">numbers.Rational</span></tt>.)</p>
<p><tt class="docutils literal"><span class="pre">Integral</span></tt> numbers derive from <tt class="docutils literal"><span class="pre">Rational</span></tt>, and can be shifted left
and right with <tt class="docutils literal"><span class="pre">&lt;&lt;</span></tt> and <tt class="docutils literal"><span class="pre">&gt;&gt;</span></tt>, combined using bitwise operations
such as <tt class="docutils literal"><span class="pre">&amp;</span></tt> and <tt class="docutils literal"><span class="pre">|</span></tt>, and can be used as array indexes and slice
boundaries.</p>
<p>In Python 3.0, the PEP slightly redefines the existing built-ins
<tt class="docutils literal"><span class="pre">round()</span></tt>, <tt class="docutils literal"><span class="pre">math.floor()</span></tt>, <tt class="docutils literal"><span class="pre">math.ceil()</span></tt>, and adds a new one,
<tt class="docutils literal"><span class="pre">math.trunc()</span></tt>, that&#8217;s been backported to Python 2.6.
<tt class="docutils literal"><span class="pre">math.trunc()</span></tt> rounds toward zero, returning the closest
<tt class="docutils literal"><span class="pre">Integral</span></tt> that&#8217;s between the function&#8217;s argument and zero.</p>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt><strong>PEP 3141</strong> - A Type Hierarchy for Numbers</dt>
<dd>PEP written by Jeffrey Yasskin.</dd>
</dl>
<p>Scheme&#8217;s numerical tower, from the Guile manual.</p>
<p>Scheme&#8217;s number datatypes from the R5RS Scheme specification.</p>
</blockquote>
<div class="section" id="the-fractions-module">
<h3>The <tt class="docutils literal"><span class="pre">fractions</span></tt> Module<a class="headerlink" href="#the-fractions-module" title="Permalink to this headline">¶</a></h3>
<p>To fill out the hierarchy of numeric types, the <tt class="docutils literal"><span class="pre">fractions</span></tt> module
provides a rational-number class.  Rational numbers store their values
as a numerator and denominator forming a fraction, and can exactly
represent numbers such as <tt class="docutils literal"><span class="pre">2/3</span></tt> that floating-point numbers can only
approximate.</p>
<p>The <tt class="docutils literal"><span class="pre">Fraction</span></tt> constructor takes two <tt class="docutils literal"><span class="pre">Integral</span></tt> values that will
be the numerator and denominator of the resulting fraction.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span> <span class="mf">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">(0.66666666666666663, 0.40000000000000002)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">+</span><span class="n">b</span>
<span class="go">Fraction(16, 15)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">/</span><span class="n">b</span>
<span class="go">Fraction(5, 3)</span>
</pre></div>
</div>
<p>For converting floating-point numbers to rationals, the float type now
has an <tt class="docutils literal"><span class="pre">as_integer_ratio()</span></tt> method that returns the numerator and
denominator for a fraction that evaluates to the same floating-point
value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span> <span class="o">.</span><span class="n">as_integer_ratio</span><span class="p">()</span>
<span class="go">(5, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mf">3.1415</span><span class="p">)</span> <span class="o">.</span><span class="n">as_integer_ratio</span><span class="p">()</span>
<span class="go">(7074029114692207L, 2251799813685248L)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3</span><span class="p">)</span> <span class="o">.</span><span class="n">as_integer_ratio</span><span class="p">()</span>
<span class="go">(6004799503160661L, 18014398509481984L)</span>
</pre></div>
</div>
<p>Note that values that can only be approximated by floating-point
numbers, such as 1./3, are not simplified to the number being
approximated; the fraction attempts to match the floating-point value
<strong>exactly</strong>.</p>
<p>The <tt class="docutils literal"><span class="pre">fractions</span></tt> module is based upon an implementation by Sjoerd
Mullender that was in Python&#8217;s <tt class="docutils literal"><span class="pre">Demo/classes/</span></tt> directory for a long
time.  This implementation was significantly updated by Jeffrey
Yasskin.</p>
</div>
</div>
<div class="section" id="other-language-changes">
<h2>Other Language Changes<a class="headerlink" href="#other-language-changes" title="Permalink to this headline">¶</a></h2>
<p>Some smaller changes made to the core Python language are:</p>
<ul>
<li><p class="first">The <tt class="docutils literal"><span class="pre">hasattr()</span></tt> function was catching and ignoring all errors,
under the assumption that they meant a <tt class="docutils literal"><span class="pre">__getattr__()</span></tt> method was
failing somehow and the return value of <tt class="docutils literal"><span class="pre">hasattr()</span></tt> would
therefore be <tt class="xref docutils literal"><span class="pre">False</span></tt>.  This logic shouldn&#8217;t be applied to
<tt class="docutils literal"><span class="pre">KeyboardInterrupt</span></tt> and <tt class="docutils literal"><span class="pre">SystemExit</span></tt>, however; Python 2.6 will
no longer discard such exceptions when <tt class="docutils literal"><span class="pre">hasattr()</span></tt> encounters
them.  (Fixed by Benjamin Peterson; issue 2196.)</p>
</li>
<li><p class="first">When calling a function using the <tt class="docutils literal"><span class="pre">**</span></tt> syntax to provide keyword
arguments, you are no longer required to use a Python dictionary;
any mapping will now work:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">sorted</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ud</span><span class="o">=</span><span class="n">UserDict</span><span class="o">.</span><span class="n">UserDict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ud</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ud</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;string&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="o">**</span><span class="n">ud</span><span class="p">)</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;]</span>
</pre></div>
</div>
<p>(Contributed by Alexander Belopolsky; issue 1686487.)</p>
<p>It&#8217;s also become legal to provide keyword arguments after a
<tt class="docutils literal"><span class="pre">*args</span></tt> argument to a function call.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">args</span><span class="p">,</span> <span class="n">kw</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="mf">4</span><span class="p">,</span><span class="mf">5</span><span class="p">,</span><span class="mf">6</span><span class="p">),</span> <span class="n">keyword</span><span class="o">=</span><span class="mf">13</span><span class="p">)</span>
<span class="go">(1, 2, 3, 4, 5, 6) {&#39;keyword&#39;: 13}</span>
</pre></div>
</div>
<p>Previously this would have been a syntax error. (Contributed by
Amaury Forgeot d&#8217;Arc; issue 3473.)</p>
</li>
<li><p class="first">A new built-in, <tt class="docutils literal"><span class="pre">next(iterator,</span> <span class="pre">[default])</span></tt> returns the next item
from the specified iterator.  If the <em>default</em> argument is supplied,
it will be returned if <em>iterator</em> has been exhausted; otherwise, the
<tt class="docutils literal"><span class="pre">StopIteration</span></tt> exception will be raised.  (Backported in issue
2719.)</p>
</li>
<li><p class="first">Tuples now have <tt class="docutils literal"><span class="pre">index()</span></tt> and <tt class="docutils literal"><span class="pre">count()</span></tt> methods matching the
list type&#8217;s <tt class="docutils literal"><span class="pre">index()</span></tt> and <tt class="docutils literal"><span class="pre">count()</span></tt> methods:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mf">3</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>(Contributed by Raymond Hettinger)</p>
</li>
<li><p class="first">The built-in types now have improved support for extended slicing
syntax, accepting various combinations of <tt class="docutils literal"><span class="pre">(start,</span> <span class="pre">stop,</span> <span class="pre">step)</span></tt>.
Previously, the support was partial and certain corner cases
wouldn&#8217;t work. (Implemented by Thomas Wouters.)</p>
</li>
<li><p class="first">Properties now have three attributes, <tt class="docutils literal"><span class="pre">getter</span></tt>, <tt class="docutils literal"><span class="pre">setter</span></tt> and
<tt class="docutils literal"><span class="pre">deleter</span></tt>, that are decorators providing useful shortcuts for
adding a getter, setter or deleter function to an existing property.
You would use them like this:</p>
<blockquote>
<dl class="docutils">
<dt>class C(object):</dt>
<dd><p class="first">&#64;property
def x(self):</p>
<blockquote>
<p>return self._x</p>
</blockquote>
<p>&#64;x.setter
def x(self, value):</p>
<blockquote>
<p>self._x = value</p>
</blockquote>
<p>&#64;x.deleter
def x(self):</p>
<blockquote class="last">
<p>del self._x</p>
</blockquote>
</dd>
<dt>class D(C):</dt>
<dd><p class="first">&#64;C.x.getter
def x(self):</p>
<blockquote>
<p>return self._x * 2</p>
</blockquote>
<p>&#64;x.setter
def x(self, value):</p>
<blockquote class="last">
<p>self._x = value / 2</p>
</blockquote>
</dd>
</dl>
</blockquote>
</li>
<li><p class="first">Several methods of the built-in set types now accept multiple
iterables: <tt class="docutils literal"><span class="pre">intersection()</span></tt>, <tt class="docutils literal"><span class="pre">intersection_update()</span></tt>,
<tt class="docutils literal"><span class="pre">union()</span></tt>, <tt class="docutils literal"><span class="pre">update()</span></tt>, <tt class="docutils literal"><span class="pre">difference()</span></tt> and
<tt class="docutils literal"><span class="pre">difference_update()</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">=</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;1234567890&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="s">&#39;abc123&#39;</span><span class="p">,</span> <span class="s">&#39;cdf246&#39;</span><span class="p">)</span>  <span class="c"># Intersection between all inputs</span>
<span class="go">set([&#39;2&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="s">&#39;246&#39;</span><span class="p">,</span> <span class="s">&#39;789&#39;</span><span class="p">)</span>
<span class="go">set([&#39;1&#39;, &#39;0&#39;, &#39;3&#39;, &#39;5&#39;])</span>
</pre></div>
</div>
<p>(Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">Many floating-point features were added.  The <tt class="docutils literal"><span class="pre">float()</span></tt> function
will now turn the string <tt class="docutils literal"><span class="pre">nan</span></tt> into an IEEE 754 Not A Number
value, and <tt class="docutils literal"><span class="pre">+inf</span></tt> and <tt class="docutils literal"><span class="pre">-inf</span></tt> into positive or negative infinity.
This works on any platform with IEEE 754 semantics.  (Contributed by
Christian Heimes; issue 1635.)</p>
<p>Other functions in the <tt class="docutils literal"><span class="pre">math</span></tt> module, <tt class="docutils literal"><span class="pre">isinf()</span></tt> and <tt class="docutils literal"><span class="pre">isnan()</span></tt>,
return true if their floating-point argument is infinite or Not A
Number.  (issue 1640)</p>
<p>Conversion functions were added to convert floating-point numbers
into hexadecimal strings (issue 3008).  These functions convert
floats to and from a string representation without introducing
rounding errors from the conversion between decimal and binary.
Floats have a <tt class="docutils literal"><span class="pre">hex()</span></tt> method that returns a string representation,
and the <tt class="docutils literal"><span class="pre">float.fromhex()</span></tt> method converts a string back into a
number:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mf">3.75</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
<span class="go">&#39;0x1.e000000000000p+1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">float</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">&#39;0x1.e000000000000p+1&#39;</span><span class="p">)</span>
<span class="go">3.75</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
<span class="go">&#39;0x1.5555555555555p-2&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first">A numerical nicety: when creating a complex number from two floats
on systems that support signed zeros (-0 and +0), the <tt class="docutils literal"><span class="pre">complex()</span></tt>
constructor will now preserve the sign of the zero.  (Fixed by Mark
T. Dickinson; issue 1507.)</p>
</li>
<li><p class="first">Classes that inherit a <tt class="docutils literal"><span class="pre">__hash__()</span></tt> method from a parent class can
set <tt class="docutils literal"><span class="pre">__hash__</span> <span class="pre">=</span> <span class="pre">None</span></tt> to indicate that the class isn&#8217;t hashable.
This will make <tt class="docutils literal"><span class="pre">hash(obj)</span></tt> raise a <tt class="docutils literal"><span class="pre">TypeError</span></tt> and the class
will not be indicated as implementing the <tt class="docutils literal"><span class="pre">Hashable</span></tt> ABC.</p>
<p>You should do this when you&#8217;ve defined a <tt class="docutils literal"><span class="pre">__cmp__()</span></tt> or
<tt class="docutils literal"><span class="pre">__eq__()</span></tt> method that compares objects by their value rather than
by identity.  All objects have a default hash method that uses
<tt class="docutils literal"><span class="pre">id(obj)</span></tt> as the hash value.  There&#8217;s no tidy way to remove the
<tt class="docutils literal"><span class="pre">__hash__()</span></tt> method inherited from a parent class, so assigning
<tt class="xref docutils literal"><span class="pre">None</span></tt> was implemented as an override.  At the C level, extensions
can set <tt class="docutils literal"><span class="pre">tp_hash</span></tt> to <tt class="docutils literal"><span class="pre">PyObject_HashNotImplemented()</span></tt>. (Fixed by
Nick Coghlan and Amaury Forgeot d&#8217;Arc; issue 2235.)</p>
</li>
<li><p class="first">Changes to the <tt class="docutils literal"><span class="pre">Exception</span></tt> interface as dictated by <strong>PEP 352</strong>
continue to be made.  For 2.6, the <tt class="docutils literal"><span class="pre">message</span></tt> attribute is being
deprecated in favor of the <tt class="docutils literal"><span class="pre">args</span></tt> attribute.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">GeneratorExit</span></tt> exception now subclasses <tt class="docutils literal"><span class="pre">BaseException</span></tt>
instead of <tt class="docutils literal"><span class="pre">Exception</span></tt>.  This means that an exception handler that
does <tt class="docutils literal"><span class="pre">except</span> <span class="pre">Exception:</span></tt> will not inadvertently catch
<tt class="docutils literal"><span class="pre">GeneratorExit</span></tt>. (Contributed by Chad Austin; issue 1537.)</p>
</li>
<li><p class="first">Generator objects now have a <tt class="docutils literal"><span class="pre">gi_code</span></tt> attribute that refers to
the original code object backing the generator. (Contributed by
Collin Winter; issue 1473257.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">compile()</span></tt> built-in function now accepts keyword arguments as
well as positional parameters.  (Contributed by Thomas Wouters;
issue 1444529.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">complex()</span></tt> constructor now accepts strings containing
parenthesized complex numbers, meaning that <tt class="docutils literal"><span class="pre">complex(repr(cplx))</span></tt>
will now round-trip values.  For example, <tt class="docutils literal"><span class="pre">complex('(3+4j)')</span></tt> now
returns the value (3+4j).  (issue 1491866)</p>
</li>
<li><p class="first">The string <tt class="docutils literal"><span class="pre">translate()</span></tt> method now accepts <tt class="xref docutils literal"><span class="pre">None</span></tt> as the
translation table parameter, which is treated as the identity
transformation.   This makes it easier to carry out operations that
only delete characters.  (Contributed by Bengt Richter and
implemented by Raymond Hettinger; issue 1193128.)</p>
</li>
<li><p class="first">The built-in <tt class="docutils literal"><span class="pre">dir()</span></tt> function now checks for a <tt class="docutils literal"><span class="pre">__dir__()</span></tt>
method on the objects it receives.  This method must return a list
of strings containing the names of valid attributes for the object,
and lets the object control the value that <tt class="docutils literal"><span class="pre">dir()</span></tt> produces.
Objects that have <tt class="docutils literal"><span class="pre">__getattr__()</span></tt> or <tt class="docutils literal"><span class="pre">__getattribute__()</span></tt>
methods can use this to advertise pseudo-attributes they will honor.
(issue 1591665)</p>
</li>
<li><p class="first">Instance method objects have new attributes for the object and
function comprising the method; the new synonym for <tt class="docutils literal"><span class="pre">im_self</span></tt> is
<tt class="docutils literal"><span class="pre">__self__</span></tt>, and <tt class="docutils literal"><span class="pre">im_func</span></tt> is also available as <tt class="docutils literal"><span class="pre">__func__</span></tt>. The
old names are still supported in Python 2.6, but are gone in 3.0.</p>
</li>
<li><p class="first">An obscure change: when you use the <tt class="docutils literal"><span class="pre">locals()</span></tt> function inside a
<tt class="docutils literal"><span class="pre">class</span></tt> statement, the resulting dictionary no longer returns free
variables.  (Free variables, in this case, are variables referenced
in the <tt class="docutils literal"><span class="pre">class</span></tt> statement  that aren&#8217;t attributes of the class.)</p>
</li>
</ul>
<div class="section" id="optimizations">
<h3>Optimizations<a class="headerlink" href="#optimizations" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The <tt class="docutils literal"><span class="pre">warnings</span></tt> module has been rewritten in C.  This makes it
possible to invoke warnings from the parser, and may also make the
interpreter&#8217;s startup faster. (Contributed by Neal Norwitz and Brett
Cannon; issue 1631171.)</p>
</li>
<li><p class="first">Type objects now have a cache of methods that can reduce the work
required to find the correct method implementation for a particular
class; once cached, the interpreter doesn&#8217;t need to traverse base
classes to figure out the right method to call. The cache is cleared
if a base class or the class itself is modified, so the cache should
remain correct even in the face of Python&#8217;s dynamic nature.
(Original optimization implemented by Armin Rigo, updated for Python
2.6 by Kevin Jacobs; issue 1700288.)</p>
<p>By default, this change is only applied to types that are included
with the Python core.  Extension modules may not necessarily be
compatible with this cache, so they must explicitly add
<tt class="docutils literal"><span class="pre">Py_TPFLAGS_HAVE_VERSION_TAG</span></tt> to the module&#8217;s <tt class="docutils literal"><span class="pre">tp_flags</span></tt> field
to enable the method cache. (To be compatible with the method cache,
the extension module&#8217;s code must not directly access and modify the
<tt class="docutils literal"><span class="pre">tp_dict</span></tt> member of any of the types it implements.  Most modules
don&#8217;t do this, but it&#8217;s impossible for the Python interpreter to
determine that. See issue 1878 for some discussion.)</p>
</li>
<li><p class="first">Function calls that use keyword arguments are significantly faster
by doing a quick pointer comparison, usually saving the time of a
full string comparison.  (Contributed by Raymond Hettinger, after an
initial implementation by Antoine Pitrou; issue 1819.)</p>
</li>
<li><p class="first">All of the functions in the <tt class="docutils literal"><span class="pre">struct</span></tt> module have been rewritten in
C, thanks to work at the Need For Speed sprint. (Contributed by
Raymond Hettinger.)</p>
</li>
<li><p class="first">Some of the standard built-in types now set a bit in their type
objects.  This speeds up checking whether an object is a subclass of
one of these types.  (Contributed by Neal Norwitz.)</p>
</li>
<li><p class="first">Unicode strings now use faster code for detecting whitespace and
line breaks; this speeds up the <tt class="docutils literal"><span class="pre">split()</span></tt> method by about 25% and
<tt class="docutils literal"><span class="pre">splitlines()</span></tt> by 35%. (Contributed by Antoine Pitrou.)  Memory
usage is reduced by using pymalloc for the Unicode string&#8217;s data.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">with</span></tt> statement now stores the <tt class="docutils literal"><span class="pre">__exit__()</span></tt> method on the
stack, producing a small speedup.  (Implemented by Jeffrey Yasskin.)</p>
</li>
<li><p class="first">To reduce memory usage, the garbage collector will now clear
internal free lists when garbage-collecting the highest generation
of objects. This may return memory to the operating system sooner.</p>
</li>
</ul>
</div>
<div class="section" id="interpreter-changes">
<h3>Interpreter Changes<a class="headerlink" href="#interpreter-changes" title="Permalink to this headline">¶</a></h3>
<p>Two command-line options have been reserved for use by other Python
implementations.  The <em>-J</em> switch has been reserved for use by Jython
for Jython-specific options, such as switches that are passed to the
underlying JVM.  <em>-X</em> has been reserved for options specific to a
particular implementation of Python such as CPython, Jython, or
IronPython.  If either option is used with Python 2.6, the interpreter
will report that the option isn&#8217;t currently used.</p>
<p>Python can now be prevented from writing <tt class="docutils literal"><span class="pre">.pyc</span></tt> or <tt class="docutils literal"><span class="pre">.pyo</span></tt> files by
supplying the <em>-B</em> switch to the Python interpreter, or by setting the
<strong>PYTHONDONTWRITEBYTECODE</strong> environment variable before running the
interpreter.  This setting is available to Python programs as the
<tt class="docutils literal"><span class="pre">sys.dont_write_bytecode</span></tt> variable, and Python code can change the
value to modify the interpreter&#8217;s behaviour.  (Contributed by Neal
Norwitz and Georg Brandl.)</p>
<p>The encoding used for standard input, output, and standard error can
be specified by setting the <strong>PYTHONIOENCODING</strong> environment variable
before running the interpreter.  The value should be a string in the
form <tt class="docutils literal"><span class="pre">&lt;encoding&gt;</span></tt> or <tt class="docutils literal"><span class="pre">&lt;encoding&gt;:&lt;errorhandler&gt;</span></tt>. The <em>encoding</em>
part specifies the encoding&#8217;s name, e.g. <tt class="docutils literal"><span class="pre">utf-8</span></tt> or <tt class="docutils literal"><span class="pre">latin-1</span></tt>; the
optional <em>errorhandler</em> part specifies what to do with characters that
can&#8217;t be handled by the encoding, and  should be one of &#8220;error&#8221;,
&#8220;ignore&#8221;, or &#8220;replace&#8221;.   (Contributed by Martin von Loewis.)</p>
</div>
</div>
<div class="section" id="new-improved-and-deprecated-modules">
<h2>New, Improved, and Deprecated Modules<a class="headerlink" href="#new-improved-and-deprecated-modules" title="Permalink to this headline">¶</a></h2>
<p>As in every release, Python&#8217;s standard library received a number of
enhancements and bug fixes.  Here&#8217;s a partial list of the most notable
changes, sorted alphabetically by module name. Consult the
<tt class="docutils literal"><span class="pre">Misc/NEWS</span></tt> file in the source tree for a more complete list of
changes, or look through the Subversion logs for all the details.</p>
<ul>
<li><p class="first">(3.0-warning mode) Python 3.0 will feature a reorganized standard
library that will drop many outdated modules and rename others.
Python 2.6 running in 3.0-warning mode will warn about these modules
when they are imported.</p>
<p>The list of deprecated modules is: <tt class="docutils literal"><span class="pre">audiodev</span></tt>, <tt class="docutils literal"><span class="pre">bgenlocations</span></tt>,
<tt class="docutils literal"><span class="pre">buildtools</span></tt>, <tt class="docutils literal"><span class="pre">bundlebuilder</span></tt>, <tt class="docutils literal"><span class="pre">Canvas</span></tt>, <tt class="docutils literal"><span class="pre">compiler</span></tt>,
<tt class="docutils literal"><span class="pre">dircache</span></tt>, <tt class="docutils literal"><span class="pre">dl</span></tt>, <tt class="docutils literal"><span class="pre">fpformat</span></tt>, <tt class="docutils literal"><span class="pre">gensuitemodule</span></tt>, <tt class="docutils literal"><span class="pre">ihooks</span></tt>,
<tt class="docutils literal"><span class="pre">imageop</span></tt>, <tt class="docutils literal"><span class="pre">imgfile</span></tt>, <tt class="docutils literal"><span class="pre">linuxaudiodev</span></tt>, <tt class="docutils literal"><span class="pre">mhlib</span></tt>,
<tt class="docutils literal"><span class="pre">mimetools</span></tt>, <tt class="docutils literal"><span class="pre">multifile</span></tt>, <tt class="docutils literal"><span class="pre">new</span></tt>, <tt class="docutils literal"><span class="pre">pure</span></tt>, <tt class="docutils literal"><span class="pre">statvfs</span></tt>,
<tt class="docutils literal"><span class="pre">sunaudiodev</span></tt>, <tt class="docutils literal"><span class="pre">test.testall</span></tt>, and <tt class="docutils literal"><span class="pre">toaiff</span></tt>.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">asyncore</span></tt> and <tt class="docutils literal"><span class="pre">asynchat</span></tt> modules are being actively
maintained again, and a number of patches and bugfixes were applied.
(Maintained by Josiah Carlson; see issue 1736190 for one patch.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">bsddb</span></tt> module also has a new maintainer, Jesús Cea, and the
package is now available as a standalone package.  The web page for
the package is www.jcea.es/programacion/pybsddb.htm. The plan is to
remove the package from the standard library in Python 3.0, because
its pace of releases is much more frequent than Python&#8217;s.</p>
<p>The <tt class="docutils literal"><span class="pre">bsddb.dbshelve</span></tt> module now uses the highest pickling protocol
available, instead of restricting itself to protocol 1. (Contributed
by W. Barnes; issue 1551443.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">cgi</span></tt> module will now read variables from the query string of
an HTTP POST request.  This makes it possible to use form actions
with URLs that include query strings such as &#8220;/cgi-
bin/add.py?category=1&#8221;.  (Contributed by Alexandre Fiori and Nubis;
issue 1817.)</p>
<p>The <tt class="docutils literal"><span class="pre">parse_qs()</span></tt> and <tt class="docutils literal"><span class="pre">parse_qsl()</span></tt> functions have been relocated
from the <tt class="docutils literal"><span class="pre">cgi</span></tt> module to the <tt class="docutils literal"><span class="pre">urlparse</span></tt> module. The versions
still available in the <tt class="docutils literal"><span class="pre">cgi</span></tt> module will trigger
<tt class="docutils literal"><span class="pre">PendingDeprecationWarning</span></tt> messages in 2.6 (issue 600362).</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">cmath</span></tt> module underwent extensive revision, contributed by
Mark Dickinson and Christian Heimes. Five new functions were added:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">polar()</span></tt> converts a complex number to polar form, returning the
modulus and argument of the complex number.</li>
<li><tt class="docutils literal"><span class="pre">rect()</span></tt> does the opposite, turning a modulus, argument pair
back into the corresponding complex number.</li>
<li><tt class="docutils literal"><span class="pre">phase()</span></tt> returns the argument (also called the angle) of a
complex number.</li>
<li><tt class="docutils literal"><span class="pre">isnan()</span></tt> returns True if either the real or imaginary part of
its argument is a NaN.</li>
<li><tt class="docutils literal"><span class="pre">isinf()</span></tt> returns True if either the real or imaginary part of
its argument is infinite.</li>
</ul>
<p>The revisions also improved the numerical soundness of the <tt class="docutils literal"><span class="pre">cmath</span></tt>
module.  For all functions, the real and imaginary parts of the
results are accurate to within a few units of least precision (ulps)
whenever possible.  See issue 1381 for the details.  The branch cuts
for <tt class="docutils literal"><span class="pre">asinh()</span></tt>, <tt class="docutils literal"><span class="pre">atanh()</span></tt>: and <tt class="docutils literal"><span class="pre">atan()</span></tt> have also been
corrected.</p>
<p>The tests for the module have been greatly expanded; nearly 2000 new
test cases exercise the algebraic functions.</p>
<p>On IEEE 754 platforms, the <tt class="docutils literal"><span class="pre">cmath</span></tt> module now handles IEEE 754
special values and floating-point exceptions in a manner consistent
with Annex &#8216;G&#8217; of the C99 standard.</p>
</li>
<li><p class="first">A new data type in the <tt class="docutils literal"><span class="pre">collections</span></tt> module:
<tt class="docutils literal"><span class="pre">namedtuple(typename,</span> <span class="pre">fieldnames)</span></tt> is a factory function that
creates subclasses of the standard tuple whose fields are accessible
by name as well as index.  For example:</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">var_type</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;variable&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s">&#39;id name type size&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Names are separated by spaces or commas.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># &#39;id, name, type, size&#39; would also work.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_type</span><span class="o">.</span><span class="n">_fields</span>
<span class="go">(&#39;id&#39;, &#39;name&#39;, &#39;type&#39;, &#39;size&#39;)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="n">var_type</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="s">&#39;frequency&#39;</span><span class="p">,</span> <span class="s">&#39;int&#39;</span><span class="p">,</span> <span class="mf">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">var</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">var</span><span class="o">.</span><span class="n">id</span>    <span class="c"># Equivalent</span>
<span class="go">1 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">var</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span> <span class="n">var</span><span class="o">.</span><span class="n">type</span>  <span class="c"># Equivalent</span>
<span class="go">int int</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="o">.</span><span class="n">_asdict</span><span class="p">()</span>
<span class="go">{&#39;size&#39;: 4, &#39;type&#39;: &#39;int&#39;, &#39;id&#39;: 1, &#39;name&#39;: &#39;frequency&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v2</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;amplitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v2</span>
<span class="go">variable(id=1, name=&#39;amplitude&#39;, type=&#39;int&#39;, size=4)</span>
</pre></div>
</div>
</blockquote>
<p>Several places in the standard library that returned tuples have
been modified to return <tt class="docutils literal"><span class="pre">namedtuple</span></tt> instances.  For example, the
<tt class="docutils literal"><span class="pre">Decimal.as_tuple()</span></tt> method now returns a named tuple with
<tt class="docutils literal"><span class="pre">sign</span></tt>, <tt class="docutils literal"><span class="pre">digits</span></tt>, and <tt class="docutils literal"><span class="pre">exponent</span></tt> fields.</p>
<p>(Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">Another change to the <tt class="docutils literal"><span class="pre">collections</span></tt> module is that the <tt class="docutils literal"><span class="pre">deque</span></tt>
type now supports an optional <em>maxlen</em> parameter; if supplied, the
deque&#8217;s size will be restricted to no more than <em>maxlen</em> items.
Adding more items to a full deque causes old items to be discarded.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dq</span><span class="o">=</span><span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mf">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dq</span>
<span class="go">deque([], maxlen=3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">dq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">dq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dq</span>
<span class="go">deque([1, 2, 3], maxlen=3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dq</span>
<span class="go">deque([2, 3, 4], maxlen=3)</span>
</pre></div>
</div>
<p>(Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">Cookie</span></tt> module&#8217;s <tt class="docutils literal"><span class="pre">Morsel</span></tt> objects now support an
<tt class="docutils literal"><span class="pre">httponly</span></tt> attribute.  In some browsers. cookies with this
attribute set cannot be accessed or manipulated by JavaScript code.
(Contributed by Arvin Schnell; issue 1638033.)</p>
</li>
<li><p class="first">A new window method in the <tt class="docutils literal"><span class="pre">curses</span></tt> module, <tt class="docutils literal"><span class="pre">chgat()</span></tt>, changes
the display attributes for a certain number of characters on a
single line.  (Contributed by Fabian Kreutz.)</p>
<blockquote>
<p># Boldface text starting at y=0,x=21
# and affecting the rest of the line.
stdscr.chgat(0, 21, curses.A_BOLD)</p>
</blockquote>
<p>The <tt class="docutils literal"><span class="pre">Textbox</span></tt> class in the <tt class="docutils literal"><span class="pre">curses.textpad</span></tt> module now supports
editing in insert mode as well as overwrite mode. Insert mode is
enabled by supplying a true value for the <em>insert_mode</em> parameter
when creating the <tt class="docutils literal"><span class="pre">Textbox</span></tt> instance.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">datetime</span></tt> module&#8217;s <tt class="docutils literal"><span class="pre">strftime()</span></tt> methods now support a
<tt class="docutils literal"><span class="pre">%f</span></tt> format code that expands to the number of microseconds in the
object, zero-padded on the left to six places.  (Contributed by Skip
Montanaro; issue 1158.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">decimal</span></tt> module was updated to version 1.66 of the General
Decimal Specification.  New features include some methods for some
basic mathematical functions such as <tt class="docutils literal"><span class="pre">exp()</span></tt> and <tt class="docutils literal"><span class="pre">log10()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Decimal</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">Decimal(&quot;2.718281828459045235360287471&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Decimal</span><span class="p">(</span><span class="s">&quot;2.7182818&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ln</span><span class="p">()</span>
<span class="go">Decimal(&quot;0.9999999895305022877376682436&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Decimal</span><span class="p">(</span><span class="mf">1000</span><span class="p">)</span><span class="o">.</span><span class="n">log10</span><span class="p">()</span>
<span class="go">Decimal(&quot;3&quot;)</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">as_tuple()</span></tt> method of <tt class="docutils literal"><span class="pre">Decimal</span></tt> objects now returns a named
tuple with <tt class="docutils literal"><span class="pre">sign</span></tt>, <tt class="docutils literal"><span class="pre">digits</span></tt>, and <tt class="docutils literal"><span class="pre">exponent</span></tt> fields.</p>
<p>(Implemented by Facundo Batista and Mark Dickinson.  Named tuple
support added by Raymond Hettinger.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">difflib</span></tt> module&#8217;s <tt class="docutils literal"><span class="pre">SequenceMatcher</span></tt> class now returns named
tuples representing matches, with <tt class="docutils literal"><span class="pre">a</span></tt>, <tt class="docutils literal"><span class="pre">b</span></tt>, and <tt class="docutils literal"><span class="pre">size</span></tt>
attributes. (Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">An optional <tt class="docutils literal"><span class="pre">timeout</span></tt> parameter, specifying a timeout measured in
seconds, was added to the <tt class="docutils literal"><span class="pre">ftplib.FTP</span></tt> class constructor as well
as the <tt class="docutils literal"><span class="pre">connect()</span></tt> method.  (Added by Facundo Batista.) Also, the
<tt class="docutils literal"><span class="pre">FTP</span></tt> class&#8217;s <tt class="docutils literal"><span class="pre">storbinary()</span></tt> and <tt class="docutils literal"><span class="pre">storlines()</span></tt> now take an
optional <em>callback</em> parameter that will be called with each block of
data after the data has been sent. (Contributed by Phil Schwartz;
issue 1221598.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">reduce()</span></tt> built-in function is also available in the
<tt class="docutils literal"><span class="pre">functools</span></tt> module.  In Python 3.0, the built-in has been dropped
and <tt class="docutils literal"><span class="pre">reduce()</span></tt> is only available from <tt class="docutils literal"><span class="pre">functools</span></tt>; currently
there are no plans to drop the built-in in the 2.x series. (Patched
by Christian Heimes; issue 1739906.)</p>
</li>
<li><p class="first">When possible, the <tt class="docutils literal"><span class="pre">getpass</span></tt> module will now use <tt class="docutils literal"><span class="pre">/dev/tty</span></tt> to
print a prompt message and read the password, falling back to
standard error and standard input.  If the password may be echoed to
the terminal, a warning is printed before the prompt is displayed.
(Contributed by Gregory P. Smith.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">glob.glob()</span></tt> function can now return Unicode filenames if a
Unicode path was used and Unicode filenames are matched within the
directory.  (issue 1001604)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">gopherlib</span></tt> module has been removed.</p>
</li>
<li><p class="first">A new function in the <tt class="docutils literal"><span class="pre">heapq</span></tt> module, <tt class="docutils literal"><span class="pre">merge(iter1,</span> <span class="pre">iter2,</span>
<span class="pre">...)</span></tt>, takes any number of iterables returning data in sorted
order, and returns a new generator that returns the contents of all
the iterators, also in sorted order.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">heapq</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">5</span><span class="p">,</span> <span class="mf">9</span><span class="p">],</span> <span class="p">[</span><span class="mf">2</span><span class="p">,</span> <span class="mf">8</span><span class="p">,</span> <span class="mf">16</span><span class="p">]))</span>
<span class="go">[1, 2, 3, 5, 8, 9, 16]</span>
</pre></div>
</div>
<p>Another new function, <tt class="docutils literal"><span class="pre">heappushpop(heap,</span> <span class="pre">item)</span></tt>, pushes <em>item</em>
onto <em>heap</em>, then pops off and returns the smallest item. This is
more efficient than making a call to <tt class="docutils literal"><span class="pre">heappush()</span></tt> and then
<tt class="docutils literal"><span class="pre">heappop()</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">heapq</span></tt> is now implemented to only use less-than comparison,
instead of the less-than-or-equal comparison it previously used.
This makes <tt class="docutils literal"><span class="pre">heapq</span></tt>&#8216;s usage of a type match the <tt class="docutils literal"><span class="pre">list.sort()</span></tt>
method. (Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">An optional <tt class="docutils literal"><span class="pre">timeout</span></tt> parameter, specifying a timeout measured in
seconds, was added to the <tt class="docutils literal"><span class="pre">httplib.HTTPConnection</span></tt> and
<tt class="docutils literal"><span class="pre">HTTPSConnection</span></tt> class constructors.  (Added by Facundo Batista.)</p>
</li>
<li><p class="first">Most of the <tt class="docutils literal"><span class="pre">inspect</span></tt> module&#8217;s functions, such as
<tt class="docutils literal"><span class="pre">getmoduleinfo()</span></tt> and <tt class="docutils literal"><span class="pre">getargs()</span></tt>, now return named tuples. In
addition to behaving like tuples, the elements of the  return value
can also be accessed as attributes. (Contributed by Raymond
Hettinger.)</p>
<p>Some new functions in the module include <tt class="docutils literal"><span class="pre">isgenerator()</span></tt>,
<tt class="docutils literal"><span class="pre">isgeneratorfunction()</span></tt>, and <tt class="docutils literal"><span class="pre">isabstract()</span></tt>.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">itertools</span></tt> module gained several new functions.</p>
<p><tt class="docutils literal"><span class="pre">izip_longest(iter1,</span> <span class="pre">iter2,</span> <span class="pre">...[,</span> <span class="pre">fillvalue])</span></tt> makes tuples from
each of the elements; if some of the iterables are shorter than
others, the missing values are set to <em>fillvalue</em>.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">tuple</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">izip_longest</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">],</span> <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">5</span><span class="p">]))</span>
<span class="go">((1, 1), (2, 2), (3, 3), (None, 4), (None, 5))</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">product(iter1,</span> <span class="pre">iter2,</span> <span class="pre">...,</span> <span class="pre">[repeat=N])</span></tt> returns the Cartesian
product of the supplied iterables, a set of tuples containing every
possible combination of the elements returned from each iterable.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">],</span> <span class="p">[</span><span class="mf">4</span><span class="p">,</span><span class="mf">5</span><span class="p">,</span><span class="mf">6</span><span class="p">]))</span>
<span class="go">[(1, 4), (1, 5), (1, 6),</span>
<span class="go"> (2, 4), (2, 5), (2, 6),</span>
<span class="go"> (3, 4), (3, 5), (3, 6)]</span>
</pre></div>
</div>
<p>The optional <em>repeat</em> keyword argument is used for taking the
product of an iterable or a set of iterables with themselves,
repeated <em>N</em> times.  With a single iterable argument, <em>N</em>-tuples are
returned:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span> <span class="n">repeat</span><span class="o">=</span><span class="mf">3</span><span class="p">))</span>
<span class="go">[(1, 1, 1), (1, 1, 2), (1, 2, 1), (1, 2, 2),</span>
<span class="go"> (2, 1, 1), (2, 1, 2), (2, 2, 1), (2, 2, 2)]</span>
</pre></div>
</div>
<p>With two iterables, <em>2N</em>-tuples are returned.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">3</span><span class="p">,</span><span class="mf">4</span><span class="p">],</span> <span class="n">repeat</span><span class="o">=</span><span class="mf">2</span><span class="p">))</span>
<span class="go">[(1, 3, 1, 3), (1, 3, 1, 4), (1, 3, 2, 3), (1, 3, 2, 4),</span>
<span class="go"> (1, 4, 1, 3), (1, 4, 1, 4), (1, 4, 2, 3), (1, 4, 2, 4),</span>
<span class="go"> (2, 3, 1, 3), (2, 3, 1, 4), (2, 3, 2, 3), (2, 3, 2, 4),</span>
<span class="go"> (2, 4, 1, 3), (2, 4, 1, 4), (2, 4, 2, 3), (2, 4, 2, 4)]</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">combinations(iterable,</span> <span class="pre">r)</span></tt> returns sub-sequences of length <em>r</em>
from the elements of <em>iterable</em>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">,</span> <span class="mf">2</span><span class="p">))</span>
<span class="go">[(&#39;1&#39;, &#39;2&#39;), (&#39;1&#39;, &#39;3&#39;), (&#39;2&#39;, &#39;3&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="s">&#39;123&#39;</span><span class="p">,</span> <span class="mf">3</span><span class="p">))</span>
<span class="go">[(&#39;1&#39;, &#39;2&#39;, &#39;3&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="s">&#39;1234&#39;</span><span class="p">,</span> <span class="mf">3</span><span class="p">))</span>
<span class="go">[(&#39;1&#39;, &#39;2&#39;, &#39;3&#39;), (&#39;1&#39;, &#39;2&#39;, &#39;4&#39;),</span>
<span class="go"> (&#39;1&#39;, &#39;3&#39;, &#39;4&#39;), (&#39;2&#39;, &#39;3&#39;, &#39;4&#39;)]</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">permutations(iter[,</span> <span class="pre">r])</span></tt> returns all the permutations of length
<em>r</em> of the iterable&#8217;s elements.  If <em>r</em> is not specified, it will
default to the number of elements produced by the iterable.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="mf">4</span><span class="p">],</span> <span class="mf">2</span><span class="p">))</span>
<span class="go">[(1, 2), (1, 3), (1, 4),</span>
<span class="go"> (2, 1), (2, 3), (2, 4),</span>
<span class="go"> (3, 1), (3, 2), (3, 4),</span>
<span class="go"> (4, 1), (4, 2), (4, 3)]</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">itertools.chain(*iterables)</span></tt> is an existing function in
<tt class="docutils literal"><span class="pre">itertools</span></tt> that gained a new constructor in Python 2.6.
<tt class="docutils literal"><span class="pre">itertools.chain.from_iterable(iterable)</span></tt> takes a single iterable
that should return other iterables.  <tt class="docutils literal"><span class="pre">chain()</span></tt> will then return
all the elements of the first iterable, then all the elements of the
second, and so on.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([[</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">],</span> <span class="p">[</span><span class="mf">4</span><span class="p">,</span><span class="mf">5</span><span class="p">,</span><span class="mf">6</span><span class="p">]]))</span>
<span class="go">[1, 2, 3, 4, 5, 6]</span>
</pre></div>
</div>
<p>(All contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">logging</span></tt> module&#8217;s <tt class="docutils literal"><span class="pre">FileHandler</span></tt> class and its subclasses
<tt class="docutils literal"><span class="pre">WatchedFileHandler</span></tt>, <tt class="docutils literal"><span class="pre">RotatingFileHandler</span></tt>, and
<tt class="docutils literal"><span class="pre">TimedRotatingFileHandler</span></tt> now have an optional <em>delay</em> parameter
to their constructors.  If <em>delay</em> is true, opening of the log file
is deferred until the first <tt class="docutils literal"><span class="pre">emit()</span></tt> call is made.  (Contributed
by Vinay Sajip.)</p>
<p><tt class="docutils literal"><span class="pre">TimedRotatingFileHandler</span></tt> also has a <em>utc</em> constructor parameter.
If the argument is true, UTC time will be used in determining when
midnight occurs and in generating filenames; otherwise local time
will be used.</p>
</li>
<li><p class="first">Several new functions were added to the <tt class="docutils literal"><span class="pre">math</span></tt> module:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">isinf()</span></tt> and <tt class="docutils literal"><span class="pre">isnan()</span></tt> determine whether a given float is a
(positive or negative) infinity or a NaN (Not a Number),
respectively.</li>
<li><tt class="docutils literal"><span class="pre">copysign()</span></tt> copies the sign bit of an IEEE 754 number,
returning the absolute value of <em>x</em> combined with the sign bit of
<em>y</em>.  For example, <tt class="docutils literal"><span class="pre">math.copysign(1,</span> <span class="pre">-0.0)</span></tt> returns -1.0.
(Contributed by Christian Heimes.)</li>
<li><tt class="docutils literal"><span class="pre">factorial()</span></tt> computes the factorial of a number. (Contributed
by Raymond Hettinger; issue 2138.)</li>
<li><tt class="docutils literal"><span class="pre">fsum()</span></tt> adds up the stream of numbers from an iterable, and is
careful to avoid loss of precision through using partial sums.
(Contributed by Jean Brouwers, Raymond Hettinger, and Mark
Dickinson; issue 2819.)</li>
<li><tt class="docutils literal"><span class="pre">acosh()</span></tt>, <tt class="docutils literal"><span class="pre">asinh()</span></tt> and <tt class="docutils literal"><span class="pre">atanh()</span></tt> compute the inverse
hyperbolic functions.</li>
<li><tt class="docutils literal"><span class="pre">log1p()</span></tt> returns the natural logarithm of <em>1+x</em> (base <em>e</em>).</li>
<li><tt class="docutils literal"><span class="pre">trunc()</span></tt> rounds a number toward zero, returning the closest
<tt class="docutils literal"><span class="pre">Integral</span></tt> that&#8217;s between the function&#8217;s argument and zero.
Added as part of the backport of PEP 3141&#8217;s type hierarchy for
numbers.</li>
</ul>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">math</span></tt> module has been improved to give more consistent
behaviour across platforms, especially with respect to handling of
floating-point exceptions and IEEE 754 special values.</p>
<p>Whenever possible, the module follows the recommendations of the C99
standard about 754&#8217;s special values.  For example, <tt class="docutils literal"><span class="pre">sqrt(-1.)</span></tt>
should now give a <tt class="docutils literal"><span class="pre">ValueError</span></tt> across almost all platforms, while
<tt class="docutils literal"><span class="pre">sqrt(float('NaN'))</span></tt> should return a NaN on all IEEE 754
platforms.  Where Annex &#8216;F&#8217; of the C99 standard recommends signaling
&#8216;divide-by-zero&#8217; or &#8216;invalid&#8217;, Python will raise <tt class="docutils literal"><span class="pre">ValueError</span></tt>.
Where Annex &#8216;F&#8217; of the C99 standard recommends signaling &#8216;overflow&#8217;,
Python will raise <tt class="docutils literal"><span class="pre">OverflowError</span></tt>.  (See issue 711019 and issue
1640.)</p>
<p>(Contributed by Christian Heimes and Mark Dickinson.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">MimeWriter</span></tt> module and <tt class="docutils literal"><span class="pre">mimify</span></tt> module have been
deprecated; use the <tt class="docutils literal"><span class="pre">email</span></tt> package instead.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">md5</span></tt> module has been deprecated; use the <tt class="docutils literal"><span class="pre">hashlib</span></tt> module
instead.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">mmap</span></tt> objects now have a <tt class="docutils literal"><span class="pre">rfind()</span></tt> method that searches for a
substring beginning at the end of the string and searching
backwards.  The <tt class="docutils literal"><span class="pre">find()</span></tt> method also gained an <em>end</em> parameter
giving an index at which to stop searching. (Contributed by John
Lenton.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">operator</span></tt> module gained a <tt class="docutils literal"><span class="pre">methodcaller()</span></tt> function that
takes a name and an optional set of arguments, returning a callable
that will call the named function on any arguments passed to it.
For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Equivalent to lambda s: s.replace(&#39;old&#39;, &#39;new&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">replacer</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">methodcaller</span><span class="p">(</span><span class="s">&#39;replace&#39;</span><span class="p">,</span> <span class="s">&#39;old&#39;</span><span class="p">,</span> <span class="s">&#39;new&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">replacer</span><span class="p">(</span><span class="s">&#39;old wine in old bottles&#39;</span><span class="p">)</span>
<span class="go">&#39;new wine in new bottles&#39;</span>
</pre></div>
</div>
<p>(Contributed by Georg Brandl, after a suggestion by Gregory
Petrosyan.)</p>
<p>The <tt class="docutils literal"><span class="pre">attrgetter()</span></tt> function now accepts dotted names and performs
the corresponding attribute lookups:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">inst_name</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span>
<span class="gp">... </span>       <span class="s">&#39;__class__.__name__&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inst_name</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="go">&#39;str&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inst_name</span><span class="p">(</span><span class="n">help</span><span class="p">)</span>
<span class="go">&#39;_Helper&#39;</span>
</pre></div>
</div>
<p>(Contributed by Georg Brandl, after a suggestion by Barry Warsaw.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">os</span></tt> module now wraps several new system calls. <tt class="docutils literal"><span class="pre">fchmod(fd,</span>
<span class="pre">mode)</span></tt> and <tt class="docutils literal"><span class="pre">fchown(fd,</span> <span class="pre">uid,</span> <span class="pre">gid)</span></tt> change the mode and ownership
of an opened file, and <tt class="docutils literal"><span class="pre">lchmod(path,</span> <span class="pre">mode)</span></tt> changes the mode of a
symlink.  (Contributed by Georg Brandl and Christian Heimes.)</p>
<p><tt class="docutils literal"><span class="pre">chflags()</span></tt> and <tt class="docutils literal"><span class="pre">lchflags()</span></tt> are wrappers for the corresponding
system calls (where they&#8217;re available), changing the flags set on a
file.  Constants for the flag values are defined in the <tt class="docutils literal"><span class="pre">stat</span></tt>
module; some possible values include <tt class="docutils literal"><span class="pre">UF_IMMUTABLE</span></tt> to signal the
file may not be changed and <tt class="docutils literal"><span class="pre">UF_APPEND</span></tt> to indicate that data can
only be appended to the file.  (Contributed by M. Levinson.)</p>
<p><tt class="docutils literal"><span class="pre">os.closerange(low,</span> <span class="pre">high)</span></tt> efficiently closes all file descriptors
from <em>low</em> to <em>high</em>, ignoring any errors and not including <em>high</em>
itself. This function is now used by the <tt class="docutils literal"><span class="pre">subprocess</span></tt> module to
make starting processes faster.  (Contributed by Georg Brandl; issue
1663329.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">os.environ</span></tt> object&#8217;s <tt class="docutils literal"><span class="pre">clear()</span></tt> method will now unset the
environment variables using <tt class="docutils literal"><span class="pre">os.unsetenv()</span></tt> in addition to
clearing the object&#8217;s keys.  (Contributed by Martin Horcicka; issue
1181.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">os.walk()</span></tt> function now has a <tt class="docutils literal"><span class="pre">followlinks</span></tt> parameter. If
set to True, it will follow symlinks pointing to directories and
visit the directory&#8217;s contents.  For backward compatibility, the
parameter&#8217;s default value is false.  Note that the function can fall
into an infinite recursion if there&#8217;s a symlink that points to a
parent directory.  (issue 1273829)</p>
</li>
<li><p class="first">In the <tt class="docutils literal"><span class="pre">os.path</span></tt> module, the <tt class="docutils literal"><span class="pre">splitext()</span></tt> function has been
changed to not split on leading period characters. This produces
better results when operating on Unix&#8217;s dot-files. For example,
<tt class="docutils literal"><span class="pre">os.path.splitext('.ipython')</span></tt> now returns <tt class="docutils literal"><span class="pre">('.ipython',</span> <span class="pre">'')</span></tt>
instead of <tt class="docutils literal"><span class="pre">('',</span> <span class="pre">'.ipython')</span></tt>. (issue 115886)</p>
<p>A new function, <tt class="docutils literal"><span class="pre">os.path.relpath(path,</span> <span class="pre">start='.')</span></tt>, returns a
relative path from the <tt class="docutils literal"><span class="pre">start</span></tt> path, if it&#8217;s supplied, or from the
current working directory to the destination <tt class="docutils literal"><span class="pre">path</span></tt>.  (Contributed
by Richard Barran; issue 1339796.)</p>
<p>On Windows, <tt class="docutils literal"><span class="pre">os.path.expandvars()</span></tt> will now expand environment
variables given in the form &#8220;%var%&#8221;, and &#8220;~user&#8221; will be expanded
into the user&#8217;s home directory path.  (Contributed by Josiah
Carlson; issue 957650.)</p>
</li>
<li><p class="first">The Python debugger provided by the <tt class="docutils literal"><span class="pre">pdb</span></tt> module gained a new
command: &#8220;run&#8221; restarts the Python program being debugged and can
optionally take new command-line arguments for the program.
(Contributed by Rocky Bernstein; issue 1393667.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">posixfile</span></tt> module has been deprecated; <tt class="docutils literal"><span class="pre">fcntl.lockf()</span></tt>
provides better locking.</p>
<p>The <tt class="docutils literal"><span class="pre">post_mortem()</span></tt> function, used to begin debugging a traceback,
will now use the traceback returned by <tt class="docutils literal"><span class="pre">sys.exc_info()</span></tt> if no
traceback is supplied.   (Contributed by Facundo Batista; issue
1106316.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">pickletools</span></tt> module now has an <tt class="docutils literal"><span class="pre">optimize()</span></tt> function that
takes a string containing a pickle and removes some unused opcodes,
returning a shorter pickle that contains the same data structure.
(Contributed by Raymond Hettinger.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">popen2</span></tt> module has been deprecated; use the <tt class="docutils literal"><span class="pre">subprocess</span></tt>
module.</p>
</li>
<li><p class="first">A <tt class="docutils literal"><span class="pre">get_data()</span></tt> function was added to the <tt class="docutils literal"><span class="pre">pkgutil</span></tt> module that
returns the contents of resource files included with an installed
Python package.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pkgutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s">&#39;test&#39;</span><span class="p">,</span> <span class="s">&#39;exception_hierarchy.txt&#39;</span><span class="p">)</span>
<span class="go">BaseException</span>
<span class="go"> +-- SystemExit</span>
<span class="go"> +-- KeyboardInterrupt</span>
<span class="go"> +-- GeneratorExit</span>
<span class="go"> +-- Exception</span>
<span class="go">      +-- StopIteration</span>
<span class="go">      +-- StandardError</span>
<span class="go"> ...</span>
</pre></div>
</div>
<p>(Contributed by Paul Moore; issue 2439.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">pyexpat</span></tt> module&#8217;s <tt class="docutils literal"><span class="pre">Parser</span></tt> objects now allow setting their
<tt class="docutils literal"><span class="pre">buffer_size</span></tt> attribute to change the size of the buffer used to
hold character data. (Contributed by Achim Gaedke; issue 1137.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">Queue</span></tt> module now provides queue variants that retrieve
entries in different orders.  The <tt class="docutils literal"><span class="pre">PriorityQueue</span></tt> class stores
queued items in a heap and retrieves them in priority order, and
<tt class="docutils literal"><span class="pre">LifoQueue</span></tt> retrieves the most recently added entries first,
meaning that it behaves like a stack. (Contributed by Raymond
Hettinger.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">random</span></tt> module&#8217;s <tt class="docutils literal"><span class="pre">Random</span></tt> objects can now be pickled on a
32-bit system and unpickled on a 64-bit system, and vice versa.
Unfortunately, this change also means that Python 2.6&#8217;s <tt class="docutils literal"><span class="pre">Random</span></tt>
objects can&#8217;t be unpickled correctly on earlier versions of Python.
(Contributed by Shawn Ligocki; issue 1727780.)</p>
<p>The new <tt class="docutils literal"><span class="pre">triangular(low,</span> <span class="pre">high,</span> <span class="pre">mode)</span></tt> function returns random
numbers following a triangular distribution.   The returned values
are between <em>low</em> and <em>high</em>, not including <em>high</em> itself, and with
<em>mode</em> as the most frequently occurring value in the distribution.
(Contributed by Wladmir van der Laan and Raymond Hettinger; issue
1681432.)</p>
</li>
<li><p class="first">Long regular expression searches carried out by the  <tt class="docutils literal"><span class="pre">re</span></tt> module
will check for signals being delivered, so time-consuming searches
can now be interrupted. (Contributed by Josh Hoyt and Ralf Schmitt;
issue 846388.)</p>
<p>The regular expression module is implemented by compiling bytecodes
for a tiny regex-specific virtual machine.  Untrusted code could
create malicious strings of bytecode directly and cause crashes, so
Python 2.6 includes a verifier for the regex bytecode. (Contributed
by Guido van Rossum from work for Google App Engine; issue 3487.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">rgbimg</span></tt> module has been removed.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">rlcompleter</span></tt> module&#8217;s <tt class="docutils literal"><span class="pre">Completer.complete()</span></tt> method will
now ignore exceptions triggered while evaluating a name. (Fixed by
Lorenz Quack; issue 2250.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">sched</span></tt> module&#8217;s <tt class="docutils literal"><span class="pre">scheduler</span></tt> instances now have a read-only
<tt class="docutils literal"><span class="pre">queue</span></tt> attribute that returns the contents of the scheduler&#8217;s
queue, represented as a list of named tuples with the fields
<tt class="docutils literal"><span class="pre">(time,</span> <span class="pre">priority,</span> <span class="pre">action,</span> <span class="pre">argument)</span></tt>. (Contributed by Raymond
Hettinger; issue 1861.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">select</span></tt> module now has wrapper functions for the Linux
<tt class="docutils literal"><span class="pre">epoll()</span></tt> and BSD <tt class="docutils literal"><span class="pre">kqueue()</span></tt> system calls. <tt class="docutils literal"><span class="pre">modify()</span></tt> method
was added to the existing <tt class="docutils literal"><span class="pre">poll</span></tt> objects; <tt class="docutils literal"><span class="pre">pollobj.modify(fd,</span>
<span class="pre">eventmask)</span></tt> takes a file descriptor or file object and an event
mask, modifying the recorded event mask for that file. (Contributed
by Christian Heimes; issue 1657.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">sets</span></tt> module has been deprecated; it&#8217;s better to use the
built-in <tt class="docutils literal"><span class="pre">set</span></tt> and <tt class="docutils literal"><span class="pre">frozenset</span></tt> types.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">sha</span></tt> module has been deprecated; use the <tt class="docutils literal"><span class="pre">hashlib</span></tt> module
instead.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">shutil.copytree()</span></tt> function now has an optional <em>ignore</em>
argument that takes a callable object.  This callable will receive
each directory path and a list of the directory&#8217;s contents, and
returns a list of names that will be ignored, not copied.</p>
<p>The <tt class="docutils literal"><span class="pre">shutil</span></tt> module also provides an <tt class="docutils literal"><span class="pre">ignore_patterns()</span></tt>
function for use with this new parameter.  <tt class="docutils literal"><span class="pre">ignore_patterns()</span></tt>
takes an arbitrary number of glob-style patterns and returns a
callable that will ignore any files and directories that match any
of these patterns.  The following example copies a directory tree,
but skips both <tt class="docutils literal"><span class="pre">.svn</span></tt> directories and Emacs backup files, which
have names ending with &#8216;~&#8217;:</p>
<blockquote>
<dl class="docutils">
<dt>shutil.copytree(&#8216;Doc/library&#8217;, &#8216;/tmp/library&#8217;,</dt>
<dd><p class="first last">ignore=shutil.ignore_patterns(&#8216;<a href="#id3"><span class="problematic" id="id4">*</span></a>~&#8217;, &#8216;.svn&#8217;))</p>
</dd>
</dl>
</blockquote>
<p>(Contributed by Tarek Ziadé; issue 2663.)</p>
</li>
<li><p class="first">Integrating signal handling with GUI handling event loops like those
used by Tkinter or GTk+ has long been a problem; most software ends
up polling, waking up every fraction of a second to check if any GUI
events have occurred. The <tt class="docutils literal"><span class="pre">signal</span></tt> module can now make this more
efficient. Calling <tt class="docutils literal"><span class="pre">signal.set_wakeup_fd(fd)</span></tt> sets a file
descriptor to be used; when a signal is received, a byte is written
to that file descriptor.  There&#8217;s also a C-level function,
<tt class="docutils literal"><span class="pre">PySignal_SetWakeupFd()</span></tt>, for setting the descriptor.</p>
<p>Event loops will use this by opening a pipe to create two
descriptors, one for reading and one for writing.  The writable
descriptor will be passed to <tt class="docutils literal"><span class="pre">set_wakeup_fd()</span></tt>, and the readable
descriptor will be added to the list of descriptors monitored by the
event loop via <tt class="docutils literal"><span class="pre">select()</span></tt> or <tt class="docutils literal"><span class="pre">poll()</span></tt>. On receiving a signal, a
byte will be written and the main event loop will be woken up,
avoiding the need to poll.</p>
<p>(Contributed by Adam Olsen; issue 1583.)</p>
<p>The <tt class="docutils literal"><span class="pre">siginterrupt()</span></tt> function is now available from Python code,
and allows changing whether signals can interrupt system calls or
not. (Contributed by Ralf Schmitt.)</p>
<p>The <tt class="docutils literal"><span class="pre">setitimer()</span></tt> and <tt class="docutils literal"><span class="pre">getitimer()</span></tt> functions have also been
added (where they&#8217;re available).  <tt class="docutils literal"><span class="pre">setitimer()</span></tt> allows setting
interval timers that will cause a signal to be delivered to the
process after a specified time, measured in wall-clock time,
consumed process time, or combined process+system time.
(Contributed by Guilherme Polo; issue 2240.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">smtplib</span></tt> module now supports SMTP over SSL thanks to the
addition of the <tt class="docutils literal"><span class="pre">SMTP_SSL</span></tt> class. This class supports an interface
identical to the existing <tt class="docutils literal"><span class="pre">SMTP</span></tt> class. (Contributed by Monty
Taylor.)  Both class constructors also have an optional <tt class="docutils literal"><span class="pre">timeout</span></tt>
parameter that specifies a timeout for the initial connection
attempt, measured in seconds.  (Contributed by Facundo Batista.)</p>
<p>An implementation of the LMTP protocol (<strong>RFC 2033</strong>) was also added
to the module.  LMTP is used in place of SMTP when transferring
e-mail between agents that don&#8217;t manage a mail queue.  (LMTP
implemented by Leif Hedstrom; issue 957003.)</p>
<p>SMTP.starttls() now complies with <strong>RFC 3207</strong> and forgets any
knowledge obtained from the server not obtained from the TLS
negotiation itself.  (Patch contributed by Bill Fenner; issue
829951.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">socket</span></tt> module now supports TIPC (<a class="reference external" href="http://tipc.sf.net">http://tipc.sf.net</a>), a
high-performance non-IP-based protocol designed for use in clustered
environments.  TIPC addresses are 4- or 5-tuples. (Contributed by
Alberto Bertogli; issue 1646.)</p>
<p>A new function, <tt class="docutils literal"><span class="pre">create_connection()</span></tt>, takes an address and
connects to it using an optional timeout value, returning the
connected socket object.</p>
</li>
<li><p class="first">The base classes in the <tt class="docutils literal"><span class="pre">SocketServer</span></tt> module now support calling
a <tt class="docutils literal"><span class="pre">handle_timeout()</span></tt> method after a span of inactivity specified
by the server&#8217;s <tt class="docutils literal"><span class="pre">timeout</span></tt> attribute.  (Contributed by Michael
Pomraning.)  The <tt class="docutils literal"><span class="pre">serve_forever()</span></tt> method now takes an optional
poll interval measured in seconds, controlling how often the server
will check for a shutdown request. (Contributed by Pedro Werneck and
Jeffrey Yasskin; issue 742598, issue 1193577.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">sqlite3</span></tt> module, maintained by Gerhard Haering, has been
updated from version 2.3.2 in Python 2.5 to version 2.4.1.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">struct</span></tt> module now supports the C99 <tt class="docutils literal"><span class="pre">_Bool</span></tt> type, using the
format character <tt class="docutils literal"><span class="pre">'?'</span></tt>. (Contributed by David Remahl.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">Popen</span></tt> objects provided by the <tt class="docutils literal"><span class="pre">subprocess</span></tt> module now have
<tt class="docutils literal"><span class="pre">terminate()</span></tt>, <tt class="docutils literal"><span class="pre">kill()</span></tt>, and <tt class="docutils literal"><span class="pre">send_signal()</span></tt> methods. On
Windows, <tt class="docutils literal"><span class="pre">send_signal()</span></tt> only supports the <tt class="docutils literal"><span class="pre">SIGTERM</span></tt> signal, and
all these methods are aliases for the Win32 API function
<tt class="docutils literal"><span class="pre">TerminateProcess()</span></tt>. (Contributed by Christian Heimes.)</p>
</li>
<li><p class="first">A new variable in the <tt class="docutils literal"><span class="pre">sys</span></tt> module, <tt class="docutils literal"><span class="pre">float_info</span></tt>, is an object
containing information derived from the <tt class="docutils literal"><span class="pre">float.h</span></tt> file about the
platform&#8217;s floating-point support.  Attributes of this object
include <tt class="docutils literal"><span class="pre">mant_dig</span></tt> (number of digits in the mantissa), <tt class="docutils literal"><span class="pre">epsilon</span></tt>
(smallest difference between 1.0 and the next largest value
representable), and several others.  (Contributed by Christian
Heimes; issue 1534.)</p>
<p>Another new variable, <tt class="docutils literal"><span class="pre">dont_write_bytecode</span></tt>, controls whether
Python writes any <tt class="docutils literal"><span class="pre">.pyc</span></tt> or <tt class="docutils literal"><span class="pre">.pyo</span></tt> files on importing a module.
If this variable is true, the compiled files are not written.  The
variable is initially set on start-up by supplying the <em>-B</em> switch
to the Python interpreter, or by setting the
<strong>PYTHONDONTWRITEBYTECODE</strong> environment variable before running the
interpreter.  Python code can subsequently change the value of this
variable to control whether bytecode files are written or not.
(Contributed by Neal Norwitz and Georg Brandl.)</p>
<p>Information about the command-line arguments supplied to the Python
interpreter is available by reading attributes of a named tuple
available as <tt class="docutils literal"><span class="pre">sys.flags</span></tt>.  For example, the <tt class="docutils literal"><span class="pre">verbose</span></tt> attribute
is true if Python was executed in verbose mode, <tt class="docutils literal"><span class="pre">debug</span></tt> is true in
debugging mode, etc. These attributes are all read-only.
(Contributed by Christian Heimes.)</p>
<p>A new function, <tt class="docutils literal"><span class="pre">getsizeof()</span></tt>, takes a Python object and returns
the amount of memory used by the object, measured in bytes.  Built-
in objects return correct results; third-party extensions may not,
but can define a <tt class="docutils literal"><span class="pre">__sizeof__()</span></tt> method to return the object&#8217;s
size. (Contributed by Robert Schuppenies; issue 2898.)</p>
<p>It&#8217;s now possible to determine the current profiler and tracer
functions by calling <tt class="docutils literal"><span class="pre">sys.getprofile()</span></tt> and <tt class="docutils literal"><span class="pre">sys.gettrace()</span></tt>.
(Contributed by Georg Brandl; issue 1648.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">tarfile</span></tt> module now supports POSIX.1-2001 (pax) tarfiles in
addition to the POSIX.1-1988 (ustar) and GNU tar formats that were
already supported.  The default format is GNU tar; specify the
<tt class="docutils literal"><span class="pre">format</span></tt> parameter to open a file using a different format:</p>
<blockquote>
<dl class="docutils">
<dt>tar = tarfile.open(&#8220;output.tar&#8221;, &#8220;w&#8221;,</dt>
<dd><p class="first last">format=tarfile.PAX_FORMAT)</p>
</dd>
</dl>
</blockquote>
<p>The new <tt class="docutils literal"><span class="pre">encoding</span></tt> and <tt class="docutils literal"><span class="pre">errors</span></tt> parameters specify an encoding
and an error handling scheme for character conversions.
<tt class="docutils literal"><span class="pre">'strict'</span></tt>, <tt class="docutils literal"><span class="pre">'ignore'</span></tt>, and <tt class="docutils literal"><span class="pre">'replace'</span></tt> are the three standard
ways Python can handle errors,; <tt class="docutils literal"><span class="pre">'utf-8'</span></tt> is a special value that
replaces bad characters with their UTF-8 representation.  (Character
conversions occur because the PAX format supports Unicode filenames,
defaulting to UTF-8 encoding.)</p>
<p>The <tt class="docutils literal"><span class="pre">TarFile.add()</span></tt> method now accepts an <tt class="docutils literal"><span class="pre">exclude</span></tt> argument
that&#8217;s a function that can be used to exclude certain filenames from
an archive. The function must take a filename and return true if the
file should be excluded or false if it should be archived. The
function is applied to both the name initially passed to <tt class="docutils literal"><span class="pre">add()</span></tt>
and to the names of files in recursively-added directories.</p>
<p>(All changes contributed by Lars Gustäbel).</p>
</li>
<li><p class="first">An optional <tt class="docutils literal"><span class="pre">timeout</span></tt> parameter was added to the
<tt class="docutils literal"><span class="pre">telnetlib.Telnet</span></tt> class constructor, specifying a timeout
measured in seconds.  (Added by Facundo Batista.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">tempfile.NamedTemporaryFile</span></tt> class usually deletes the
temporary file it created when the file is closed.  This behaviour
can now be changed by passing <tt class="docutils literal"><span class="pre">delete=False</span></tt> to the constructor.
(Contributed by Damien Miller; issue 1537850.)</p>
<p>A new class, <tt class="docutils literal"><span class="pre">SpooledTemporaryFile</span></tt>, behaves like a temporary file
but stores its data in memory until a maximum size is exceeded.  On
reaching that limit, the contents will be written to an on-disk
temporary file.  (Contributed by Dustin J. Mitchell.)</p>
<p>The <tt class="docutils literal"><span class="pre">NamedTemporaryFile</span></tt> and <tt class="docutils literal"><span class="pre">SpooledTemporaryFile</span></tt> classes both
work as context managers, so you can write <tt class="docutils literal"><span class="pre">with</span>
<span class="pre">tempfile.NamedTemporaryFile()</span> <span class="pre">as</span> <span class="pre">tmp:</span> <span class="pre">...</span></tt>. (Contributed by
Alexander Belopolsky; issue 2021.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">test.test_support</span></tt> module gained a number of context managers
useful for writing tests. <tt class="docutils literal"><span class="pre">EnvironmentVarGuard()</span></tt> is a context
manager that temporarily changes environment variables and
automatically restores them to their old values.</p>
<p>Another context manager, <tt class="docutils literal"><span class="pre">TransientResource</span></tt>, can surround calls
to resources that may or may not be available; it will catch and
ignore a specified list of exceptions.  For example, a network test
may ignore certain failures when connecting to an external web site:</p>
<blockquote>
<dl class="docutils">
<dt>with test_support.TransientResource(IOError,</dt>
<dd><blockquote class="first">
<p>errno=errno.ETIMEDOUT):</p>
</blockquote>
<p class="last">f = urllib.urlopen(&#8216;<a class="reference external" href="https://sf.net">https://sf.net</a>&#8216;)
...</p>
</dd>
</dl>
</blockquote>
<p>Finally, <tt class="docutils literal"><span class="pre">check_warnings()</span></tt> resets the <tt class="docutils literal"><span class="pre">warning</span></tt> module&#8217;s
warning filters and returns an object that will record all warning
messages triggered (issue 3781):</p>
<blockquote>
<dl class="docutils">
<dt>with test_support.check_warnings() as wrec:</dt>
<dd><p class="first last">warnings.simplefilter(&#8220;always&#8221;)
# ... code that triggers a warning ...
assert str(wrec.message) == &#8220;function is outdated&#8221;
assert len(wrec.warnings) == 1, &#8220;Multiple warnings raised&#8221;</p>
</dd>
</dl>
</blockquote>
<p>(Contributed by Brett Cannon.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">textwrap</span></tt> module can now preserve existing whitespace at the
beginnings and ends of the newly-created lines by specifying
<tt class="docutils literal"><span class="pre">drop_whitespace=False</span></tt> as an argument:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;This  sentence  has a bunch   of</span>
<span class="gp">... </span><span class="s">  extra   whitespace.&quot;&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">15</span><span class="p">)</span>
<span class="go">This  sentence</span>
<span class="go">has a bunch</span>
<span class="go">of    extra</span>
<span class="go">whitespace.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">drop_whitespace</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">15</span><span class="p">)</span>
<span class="go">This  sentence</span>
<span class="go">  has a bunch</span>
<span class="go">   of    extra</span>
<span class="go">   whitespace.</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>(Contributed by Dwayne Bailey; issue 1581073.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">threading</span></tt> module API is being changed to use properties such
as <tt class="docutils literal"><span class="pre">daemon</span></tt> instead of <tt class="docutils literal"><span class="pre">setDaemon()</span></tt> and <tt class="docutils literal"><span class="pre">isDaemon()</span></tt> methods,
and some methods have been renamed to use underscores instead of
camel-case; for example, the <tt class="docutils literal"><span class="pre">activeCount()</span></tt> method is renamed to
<tt class="docutils literal"><span class="pre">active_count()</span></tt>.  Both the 2.6 and 3.0 versions of the module
support the same properties and renamed methods, but don&#8217;t remove
the old methods.  No date has been set for the deprecation of the
old APIs in Python 3.x; the old APIs won&#8217;t be removed in any 2.x
version. (Carried out by several people, most notably Benjamin
Peterson.)</p>
<p>The <tt class="docutils literal"><span class="pre">threading</span></tt> module&#8217;s <tt class="docutils literal"><span class="pre">Thread</span></tt> objects gained an <tt class="docutils literal"><span class="pre">ident</span></tt>
property that returns the thread&#8217;s identifier, a nonzero integer.
(Contributed by Gregory P. Smith; issue 2871.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">timeit</span></tt> module now accepts callables as well as strings for
the statement being timed and for the setup code. Two convenience
functions were added for creating <tt class="docutils literal"><span class="pre">Timer</span></tt> instances:
<tt class="docutils literal"><span class="pre">repeat(stmt,</span> <span class="pre">setup,</span> <span class="pre">time,</span> <span class="pre">repeat,</span> <span class="pre">number)</span></tt> and <tt class="docutils literal"><span class="pre">timeit(stmt,</span>
<span class="pre">setup,</span> <span class="pre">time,</span> <span class="pre">number)</span></tt> create an instance and call the corresponding
method. (Contributed by Erik Demaine; issue 1533909.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">Tkinter</span></tt> module now accepts lists and tuples for options,
separating the elements by spaces before passing the resulting value
to Tcl/Tk. (Contributed by Guilherme Polo; issue 2906.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">turtle</span></tt> module for turtle graphics was greatly enhanced by
Gregor Lingl.  New features in the module include:</p>
<ul class="simple">
<li>Better animation of turtle movement and rotation.</li>
<li>Control over turtle movement using the new <tt class="docutils literal"><span class="pre">delay()</span></tt>,
<tt class="docutils literal"><span class="pre">tracer()</span></tt>, and <tt class="docutils literal"><span class="pre">speed()</span></tt> methods.</li>
<li>The ability to set new shapes for the turtle, and to define a new
coordinate system.</li>
<li>Turtles now have an <tt class="docutils literal"><span class="pre">undo()</span></tt> method that can roll back actions.</li>
<li>Simple support for reacting to input events such as mouse and
keyboard activity, making it possible to write simple games.</li>
<li>A <tt class="docutils literal"><span class="pre">turtle.cfg</span></tt> file can be used to customize the starting
appearance of the turtle&#8217;s screen.</li>
<li>The module&#8217;s docstrings can be replaced by new docstrings that
have been translated into another language.</li>
</ul>
<p>(issue 1513695)</p>
</li>
<li><p class="first">An optional <tt class="docutils literal"><span class="pre">timeout</span></tt> parameter was added to the
<tt class="docutils literal"><span class="pre">urllib.urlopen()</span></tt> function and the <tt class="docutils literal"><span class="pre">urllib.ftpwrapper</span></tt> class
constructor, as well as the <tt class="docutils literal"><span class="pre">urllib2.urlopen()</span></tt> function.  The
parameter specifies a timeout measured in seconds.   For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s">&quot;http://slow.example.com&quot;</span><span class="p">,</span>
<span class="go">                        timeout=3)</span>
<span class="gt">Traceback (most recent call last):</span>
  <span class="c">...</span>
<span class="nc">urllib2.URLError</span>: <span class="n-Identifier">&lt;urlopen error timed out&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>(Added by Facundo Batista.)</p>
</li>
<li><p class="first">The Unicode database provided by the <tt class="docutils literal"><span class="pre">unicodedata</span></tt> module has been
updated to version 5.1.0.  (Updated by Martin von Loewis; issue
3811.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">warnings</span></tt> module&#8217;s <tt class="docutils literal"><span class="pre">formatwarning()</span></tt> and <tt class="docutils literal"><span class="pre">showwarning()</span></tt>
gained an optional <em>line</em> argument that can be used to supply the
line of source code.  (Added as part of issue 1631171, which re-
implemented part of the <tt class="docutils literal"><span class="pre">warnings</span></tt> module in C code.)</p>
<p>A new function, <tt class="docutils literal"><span class="pre">catch_warnings()</span></tt>, is a context manager intended
for testing purposes that lets you temporarily modify the warning
filters and then restore their original values (issue 3781).</p>
</li>
<li><p class="first">The XML-RPC <tt class="docutils literal"><span class="pre">SimpleXMLRPCServer</span></tt> and <tt class="docutils literal"><span class="pre">DocXMLRPCServer</span></tt> classes
can now be prevented from immediately opening and binding to their
socket by passing True as the <tt class="docutils literal"><span class="pre">bind_and_activate</span></tt> constructor
parameter.  This can be used to modify the instance&#8217;s
<tt class="docutils literal"><span class="pre">allow_reuse_address</span></tt> attribute before calling the
<tt class="docutils literal"><span class="pre">server_bind()</span></tt> and <tt class="docutils literal"><span class="pre">server_activate()</span></tt> methods to open the
socket and begin listening for connections. (Contributed by Peter
Parente; issue 1599845.)</p>
<p><tt class="docutils literal"><span class="pre">SimpleXMLRPCServer</span></tt> also has a <tt class="docutils literal"><span class="pre">_send_traceback_header</span></tt>
attribute; if true, the exception and formatted traceback are
returned as HTTP headers &#8220;X-Exception&#8221; and &#8220;X-Traceback&#8221;.  This
feature is for debugging purposes only and should not be used on
production servers because the tracebacks might reveal passwords or
other sensitive information.  (Contributed by Alan McIntyre as part
of his project for Google&#8217;s Summer of Code 2007.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">xmlrpclib</span></tt> module no longer automatically converts
<tt class="docutils literal"><span class="pre">datetime.date</span></tt> and <tt class="docutils literal"><span class="pre">datetime.time</span></tt> to the
<tt class="docutils literal"><span class="pre">xmlrpclib.DateTime</span></tt> type; the conversion semantics were not
necessarily correct for all applications.  Code using <tt class="docutils literal"><span class="pre">xmlrpclib</span></tt>
should convert <tt class="docutils literal"><span class="pre">date</span></tt> and <tt class="docutils literal"><span class="pre">time</span></tt> instances. (issue 1330538)  The
code can also handle dates before 1900 (contributed by Ralf Schmitt;
issue 2014) and 64-bit integers represented by using <tt class="docutils literal"><span class="pre">&lt;i8&gt;</span></tt> in
XML-RPC responses (contributed by Riku Lindblad; issue 2985).</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">zipfile</span></tt> module&#8217;s <tt class="docutils literal"><span class="pre">ZipFile</span></tt> class now has <tt class="docutils literal"><span class="pre">extract()</span></tt> and
<tt class="docutils literal"><span class="pre">extractall()</span></tt> methods that will unpack a single file or all the
files in the archive to the current directory, or to a specified
directory:</p>
<blockquote>
<p>z = zipfile.ZipFile(&#8216;python-251.zip&#8217;)</p>
<p># Unpack a single file, writing it relative
# to the /tmp directory.
z.extract(&#8216;Python/sysmodule.c&#8217;, &#8216;/tmp&#8217;)</p>
<p># Unpack all the files in the archive.
z.extractall()</p>
</blockquote>
<p>(Contributed by Alan McIntyre; issue 467924.)</p>
<p>The <tt class="docutils literal"><span class="pre">open()</span></tt>, <tt class="docutils literal"><span class="pre">read()</span></tt> and <tt class="docutils literal"><span class="pre">extract()</span></tt> methods can now take
either a filename or a <tt class="docutils literal"><span class="pre">ZipInfo</span></tt> object.  This is useful when an
archive accidentally contains a duplicated filename. (Contributed by
Graham Horler; issue 1775025.)</p>
<p>Finally, <tt class="docutils literal"><span class="pre">zipfile</span></tt> now supports using Unicode filenames for
archived files.  (Contributed by Alexey Borzenkov; issue 1734346.)</p>
</li>
</ul>
<div class="section" id="the-ast-module">
<h3>The <tt class="docutils literal"><span class="pre">ast</span></tt> module<a class="headerlink" href="#the-ast-module" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">ast</span></tt> module provides an Abstract Syntax Tree representation of
Python code, and Armin Ronacher contributed a set of helper functions
that perform a variety of common tasks.  These will be useful for HTML
templating packages, code analyzers, and similar tools that process
Python code.</p>
<p>The <tt class="docutils literal"><span class="pre">parse()</span></tt> function takes an expression and returns an AST. The
<tt class="docutils literal"><span class="pre">dump()</span></tt> function outputs a representation of a tree, suitable for
debugging:</p>
<blockquote>
<p>import ast</p>
<p>t = ast.parse(&#8220;&#8221;&#8221;
d = {}
for i in &#8216;abcdefghijklm&#8217;:</p>
<blockquote>
d[i + i] = ord(i) - ord(&#8216;a&#8217;) + 1</blockquote>
<p>print d
&#8220;&#8221;&#8220;)
print ast.dump(t)</p>
</blockquote>
<p>This outputs a deeply nested tree:</p>
<blockquote>
<dl class="docutils">
<dt>Module(body=[</dt>
<dd><blockquote class="first">
<dl class="docutils">
<dt>Assign(targets=[</dt>
<dd><blockquote class="first">
Name(id=&#8217;d&#8217;, ctx=Store())</blockquote>
<p class="last">], value=Dict(keys=[], values=[]))</p>
</dd>
<dt>For(target=Name(id=&#8217;i&#8217;, ctx=Store()),</dt>
<dd><blockquote class="first">
<blockquote>
iter=Str(s=&#8217;abcdefghijklm&#8217;), body=[</blockquote>
<dl class="docutils">
<dt>Assign(targets=[</dt>
<dd><blockquote class="first">
<dl class="docutils">
<dt>Subscript(value=</dt>
<dd><dl class="first last docutils">
<dt>Name(id=&#8217;d&#8217;, ctx=Load()),</dt>
<dd><p class="first">slice=
Index(value=</p>
<blockquote class="last">
<dl class="docutils">
<dt>BinOp(left=Name(id=&#8217;i&#8217;, ctx=Load()), op=Add(),</dt>
<dd>right=Name(id=&#8217;i&#8217;, ctx=Load()))), ctx=Store())</dd>
</dl>
</blockquote>
</dd>
</dl>
</dd>
</dl>
</blockquote>
<p>], value=
BinOp(left=</p>
<blockquote class="last">
<dl class="docutils">
<dt>BinOp(left=</dt>
<dd><dl class="first docutils">
<dt>Call(func=</dt>
<dd><dl class="first last docutils">
<dt>Name(id=&#8217;ord&#8217;, ctx=Load()), args=[</dt>
<dd><blockquote class="first">
Name(id=&#8217;i&#8217;, ctx=Load())</blockquote>
<p class="last">], keywords=[], starargs=None, kwargs=None),</p>
</dd>
</dl>
</dd>
<dt>op=Sub(), right=Call(func=</dt>
<dd><dl class="first last docutils">
<dt>Name(id=&#8217;ord&#8217;, ctx=Load()), args=[</dt>
<dd><blockquote class="first">
Str(s=&#8217;a&#8217;)</blockquote>
<p class="last">], keywords=[], starargs=None, kwargs=None)),</p>
</dd>
</dl>
</dd>
</dl>
<p class="last">op=Add(), right=Num(n=1)))</p>
</dd>
</dl>
</blockquote>
</dd>
</dl>
<p>], orelse=[])</p>
</blockquote>
<dl class="docutils">
<dt>Print(dest=None, values=[</dt>
<dd>Name(id=&#8217;d&#8217;, ctx=Load())</dd>
</dl>
<p class="last">], nl=True)</p>
</dd>
</dl>
</blockquote>
<p class="last">])</p>
</dd>
</dl>
</blockquote>
<p>The <tt class="docutils literal"><span class="pre">literal_eval()</span></tt> method takes a string or an AST representing a
literal expression, parses and evaluates it, and returns the resulting
value.  A literal expression is a Python expression containing only
strings, numbers, dictionaries, etc. but no statements or function
calls.  If you need to evaluate an expression but cannot accept the
security risk of using an <tt class="docutils literal"><span class="pre">eval()</span></tt> call, <tt class="docutils literal"><span class="pre">literal_eval()</span></tt> will
handle it safely:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">literal</span> <span class="o">=</span> <span class="s">&#39;(&quot;a&quot;, &quot;b&quot;, {2:4, 3:8, 1:2})&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">literal</span><span class="p">)</span>
<span class="go">(&#39;a&#39;, &#39;b&#39;, {1: 2, 2: 4, 3: 8})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="s">&#39;&quot;a&quot; + &quot;b&quot;&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  <span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">malformed string</span>
</pre></div>
</div>
<p>The module also includes <tt class="docutils literal"><span class="pre">NodeVisitor</span></tt> and <tt class="docutils literal"><span class="pre">NodeTransformer</span></tt>
classes for traversing and modifying an AST, and functions for common
transformations such as changing line numbers.</p>
</div>
<div class="section" id="the-future-builtins-module">
<h3>The <tt class="docutils literal"><span class="pre">future_builtins</span></tt> module<a class="headerlink" href="#the-future-builtins-module" title="Permalink to this headline">¶</a></h3>
<p>Python 3.0 makes many changes to the repertoire of built-in functions,
and most of the changes can&#8217;t be introduced in the Python 2.x series
because they would break compatibility. The <tt class="docutils literal"><span class="pre">future_builtins</span></tt> module
provides versions of these built-in functions that can be imported
when writing 3.0-compatible code.</p>
<p>The functions in this module currently include:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">ascii(obj)</span></tt>: equivalent to <tt class="docutils literal"><span class="pre">repr()</span></tt>.  In Python 3.0, <tt class="docutils literal"><span class="pre">repr()</span></tt>
will return a Unicode string, while <tt class="docutils literal"><span class="pre">ascii()</span></tt> will return a pure
ASCII bytestring.</li>
<li><tt class="docutils literal"><span class="pre">filter(predicate,</span> <span class="pre">iterable)</span></tt>, <tt class="docutils literal"><span class="pre">map(func,</span> <span class="pre">iterable1,</span> <span class="pre">...)</span></tt>: the
3.0 versions return iterators, unlike the 2.x built-ins which return
lists.</li>
<li><tt class="docutils literal"><span class="pre">hex(value)</span></tt>, <tt class="docutils literal"><span class="pre">oct(value)</span></tt>: instead of calling the <tt class="docutils literal"><span class="pre">__hex__()</span></tt>
or <tt class="docutils literal"><span class="pre">__oct__()</span></tt> methods, these versions will call the
<tt class="docutils literal"><span class="pre">__index__()</span></tt> method and convert the result to hexadecimal or
octal.  <tt class="docutils literal"><span class="pre">oct()</span></tt> will use the new <tt class="docutils literal"><span class="pre">0o</span></tt> notation for its result.</li>
</ul>
</div>
<div class="section" id="the-json-module-javascript-object-notation">
<h3>The <tt class="docutils literal"><span class="pre">json</span></tt> module: JavaScript Object Notation<a class="headerlink" href="#the-json-module-javascript-object-notation" title="Permalink to this headline">¶</a></h3>
<p>The new <tt class="docutils literal"><span class="pre">json</span></tt> module supports the encoding and decoding of Python
types in JSON (Javascript Object Notation). JSON is a lightweight
interchange format often used in web applications. For more
information about JSON, see <a class="reference external" href="http://www.json.org">http://www.json.org</a>.</p>
<p><tt class="docutils literal"><span class="pre">json</span></tt> comes with support for decoding and encoding most builtin
Python types. The following example encodes and decodes a dictionary:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">json</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;spam&quot;</span> <span class="p">:</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;parrot&quot;</span> <span class="p">:</span> <span class="mf">42</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">in_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c"># Encode the data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">in_json</span>
<span class="go">&#39;{&quot;parrot&quot;: 42, &quot;spam&quot;: &quot;foo&quot;}&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">in_json</span><span class="p">)</span> <span class="c"># Decode into a Python object</span>
<span class="go">{&quot;spam&quot; : &quot;foo&quot;, &quot;parrot&quot; : 42}</span>
</pre></div>
</div>
<p>It&#8217;s also possible to write your own decoders and encoders to support
more types. Pretty-printing of the JSON strings is also supported.</p>
<p><tt class="docutils literal"><span class="pre">json</span></tt> (originally called simplejson) was written by Bob Ippolito.</p>
</div>
<div class="section" id="the-plistlib-module-a-property-list-parser">
<h3>The <tt class="docutils literal"><span class="pre">plistlib</span></tt> module: A Property-List Parser<a class="headerlink" href="#the-plistlib-module-a-property-list-parser" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">.plist</span></tt> format is commonly used on Mac OS X to store basic data
types (numbers, strings, lists, and dictionaries) by serializing them
into an XML-based format. It resembles the XML-RPC serialization of
data types.</p>
<p>Despite being primarily used on Mac OS X, the format has nothing Mac-
specific about it and the Python implementation works on any platform
that Python supports, so the <tt class="docutils literal"><span class="pre">plistlib</span></tt> module has been promoted to
the standard library.</p>
<p>Using the module is simple:</p>
<blockquote>
<p>import sys
import plistlib
import datetime</p>
<p># Create data structure
data_struct = dict(lastAccessed=datetime.datetime.now(),</p>
<blockquote>
version=1,
categories=(&#8216;Personal&#8217;,&#8217;Shared&#8217;,&#8217;Private&#8217;))</blockquote>
<p># Create string containing XML.
plist_str = plistlib.writePlistToString(data_struct)
new_struct = plistlib.readPlistFromString(plist_str)
print data_struct
print new_struct</p>
<p># Write data structure to a file and read it back.
plistlib.writePlist(data_struct, &#8216;/tmp/customizations.plist&#8217;)
new_struct = plistlib.readPlist(&#8216;/tmp/customizations.plist&#8217;)</p>
<p># read/writePlist accepts file-like objects as well as paths.
plistlib.writePlist(data_struct, sys.stdout)</p>
</blockquote>
</div>
<div class="section" id="ctypes-enhancements">
<h3>ctypes Enhancements<a class="headerlink" href="#ctypes-enhancements" title="Permalink to this headline">¶</a></h3>
<p>Thomas Heller continued to maintain and enhance the <tt class="docutils literal"><span class="pre">ctypes</span></tt> module.</p>
<p><tt class="docutils literal"><span class="pre">ctypes</span></tt> now supports a <tt class="docutils literal"><span class="pre">c_bool</span></tt> datatype that represents the C99
<tt class="docutils literal"><span class="pre">bool</span></tt> type.  (Contributed by David Remahl; issue 1649190.)</p>
<p>The <tt class="docutils literal"><span class="pre">ctypes</span></tt> string, buffer and array types have improved support
for extended slicing syntax, where various combinations of <tt class="docutils literal"><span class="pre">(start,</span>
<span class="pre">stop,</span> <span class="pre">step)</span></tt> are supplied. (Implemented by Thomas Wouters.)</p>
<p>All <tt class="docutils literal"><span class="pre">ctypes</span></tt> data types now support <tt class="docutils literal"><span class="pre">from_buffer()</span></tt> and
<tt class="docutils literal"><span class="pre">from_buffer_copy()</span></tt> methods that create a ctypes instance based on
a provided buffer object.  <tt class="docutils literal"><span class="pre">from_buffer_copy()</span></tt> copies the contents
of the object, while <tt class="docutils literal"><span class="pre">from_buffer()</span></tt> will share the same memory
area.</p>
<p>A new calling convention tells <tt class="docutils literal"><span class="pre">ctypes</span></tt> to clear the <tt class="docutils literal"><span class="pre">errno</span></tt> or
Win32 LastError variables at the outset of each wrapped call.
(Implemented by Thomas Heller; issue 1798.)</p>
<p>You can now retrieve the Unix <tt class="docutils literal"><span class="pre">errno</span></tt> variable after a function
call.  When creating a wrapped function, you can supply
<tt class="docutils literal"><span class="pre">use_errno=True</span></tt> as a keyword parameter to the <tt class="docutils literal"><span class="pre">DLL()</span></tt> function
and then call the module-level methods <tt class="docutils literal"><span class="pre">set_errno()</span></tt> and
<tt class="docutils literal"><span class="pre">get_errno()</span></tt> to set and retrieve the error value.</p>
<p>The Win32 LastError variable is similarly supported by the <tt class="docutils literal"><span class="pre">DLL()</span></tt>,
<tt class="docutils literal"><span class="pre">OleDLL()</span></tt>, and <tt class="docutils literal"><span class="pre">WinDLL()</span></tt> functions. You supply
<tt class="docutils literal"><span class="pre">use_last_error=True</span></tt> as a keyword parameter and then call the
module-level methods <tt class="docutils literal"><span class="pre">set_last_error()</span></tt> and <tt class="docutils literal"><span class="pre">get_last_error()</span></tt>.</p>
<p>The <tt class="docutils literal"><span class="pre">byref()</span></tt> function, used to retrieve a pointer to a ctypes
instance, now has an optional <em>offset</em> parameter that is a byte count
that will be added to the returned pointer.</p>
</div>
<div class="section" id="improved-ssl-support">
<h3>Improved SSL Support<a class="headerlink" href="#improved-ssl-support" title="Permalink to this headline">¶</a></h3>
<p>Bill Janssen made extensive improvements to Python 2.6&#8217;s support for
the Secure Sockets Layer by adding a new module, <tt class="docutils literal"><span class="pre">ssl</span></tt>, that&#8217;s built
atop the OpenSSL library. This new module provides more control over
the protocol negotiated, the X.509 certificates used, and has better
support for writing SSL servers (as opposed to clients) in Python.
The existing SSL support in the <tt class="docutils literal"><span class="pre">socket</span></tt> module hasn&#8217;t been removed
and continues to work, though it will be removed in Python 3.0.</p>
<p>To use the new module, you must first create a TCP connection in the
usual way and then pass it to the <tt class="docutils literal"><span class="pre">ssl.wrap_socket()</span></tt> function. It&#8217;s
possible to specify whether a certificate is required, and to obtain
certificate info by calling the <tt class="docutils literal"><span class="pre">getpeercert()</span></tt> method.</p>
<p>See also:</p>
<blockquote>
The documentation for the <tt class="docutils literal"><span class="pre">ssl</span></tt> module.</blockquote>
</div>
</div>
<div class="section" id="build-and-c-api-changes">
<h2>Build and C API Changes<a class="headerlink" href="#build-and-c-api-changes" title="Permalink to this headline">¶</a></h2>
<p>Changes to Python&#8217;s build process and to the C API include:</p>
<ul>
<li><p class="first">Python now must be compiled with C89 compilers (after 19 years!).
This means that the Python source tree has dropped its own
implementations of <tt class="docutils literal"><span class="pre">memmove()</span></tt> and <tt class="docutils literal"><span class="pre">strerror()</span></tt>, which are in
the C89 standard library.</p>
</li>
<li><p class="first">Python 2.6 can be built with Microsoft Visual Studio 2008 (version
9.0), and this is the new default compiler.  See the <tt class="docutils literal"><span class="pre">PCbuild</span></tt>
directory for the build files.  (Implemented by Christian Heimes.)</p>
</li>
<li><p class="first">On Mac OS X, Python 2.6 can be compiled as a 4-way universal build.
The <strong>configure</strong> script can take a <em>&#8211;with-universal-
archs=[32-bit|64-bit|all]</em> switch, controlling whether the binaries
are built for 32-bit architectures (x86, PowerPC), 64-bit (x86-64
and PPC-64), or both. (Contributed by Ronald Oussoren.)</p>
</li>
<li><p class="first">The BerkeleyDB module now has a C API object, available as
<tt class="docutils literal"><span class="pre">bsddb.db.api</span></tt>.   This object can be used by other C extensions
that wish to use the <tt class="docutils literal"><span class="pre">bsddb</span></tt> module for their own purposes.
(Contributed by Duncan Grisby; issue 1551895.)</p>
</li>
<li><p class="first">The new buffer interface, previously described in the PEP 3118
section, adds <tt class="docutils literal"><span class="pre">PyObject_GetBuffer()</span></tt> and <tt class="docutils literal"><span class="pre">PyBuffer_Release()</span></tt>,
as well as a few other functions.</p>
</li>
<li><p class="first">Python&#8217;s use of the C stdio library is now thread-safe, or at least
as thread-safe as the underlying library is.  A long-standing
potential bug occurred if one thread closed a file object while
another thread was reading from or writing to the object.  In 2.6
file objects have a reference count, manipulated by the
<tt class="docutils literal"><span class="pre">PyFile_IncUseCount()</span></tt> and <tt class="docutils literal"><span class="pre">PyFile_DecUseCount()</span></tt> functions.
File objects can&#8217;t be closed unless the reference count is zero.
<tt class="docutils literal"><span class="pre">PyFile_IncUseCount()</span></tt> should be called while the GIL is still
held, before carrying out an I/O operation using the <tt class="docutils literal"><span class="pre">FILE</span> <span class="pre">*</span></tt>
pointer, and <tt class="docutils literal"><span class="pre">PyFile_DecUseCount()</span></tt> should be called immediately
after the GIL is re-acquired. (Contributed by Antoine Pitrou and
Gregory P. Smith.)</p>
</li>
<li><p class="first">Importing modules simultaneously in two different threads no longer
deadlocks; it will now raise an <tt class="docutils literal"><span class="pre">ImportError</span></tt>.  A new API
function, <tt class="docutils literal"><span class="pre">PyImport_ImportModuleNoBlock()</span></tt>, will look for a module
in <tt class="docutils literal"><span class="pre">sys.modules</span></tt> first, then try to import it after acquiring an
import lock.  If the import lock is held by another thread, an
<tt class="docutils literal"><span class="pre">ImportError</span></tt> is raised. (Contributed by Christian Heimes.)</p>
</li>
<li><p class="first">Several functions return information about the platform&#8217;s floating-
point support.  <tt class="docutils literal"><span class="pre">PyFloat_GetMax()</span></tt> returns the maximum
representable floating point value, and <tt class="docutils literal"><span class="pre">PyFloat_GetMin()</span></tt> returns
the minimum positive value.  <tt class="docutils literal"><span class="pre">PyFloat_GetInfo()</span></tt> returns an object
containing more information from the <tt class="docutils literal"><span class="pre">float.h</span></tt> file, such as
<tt class="docutils literal"><span class="pre">&quot;mant_dig&quot;</span></tt> (number of digits in the mantissa), <tt class="docutils literal"><span class="pre">&quot;epsilon&quot;</span></tt>
(smallest difference between 1.0 and the next largest value
representable), and several others. (Contributed by Christian
Heimes; issue 1534.)</p>
</li>
<li><p class="first">C functions and methods that use <tt class="docutils literal"><span class="pre">PyComplex_AsCComplex()</span></tt> will now
accept arguments that have a <tt class="docutils literal"><span class="pre">__complex__()</span></tt> method.  In
particular, the functions in the <tt class="docutils literal"><span class="pre">cmath</span></tt> module will now accept
objects with this method. This is a backport of a Python 3.0 change.
(Contributed by Mark Dickinson; issue 1675423.)</p>
</li>
<li><p class="first">Python&#8217;s C API now includes two functions for case-insensitive
string comparisons, <tt class="docutils literal"><span class="pre">PyOS_stricmp(char*,</span> <span class="pre">char*)</span></tt> and
<tt class="docutils literal"><span class="pre">PyOS_strnicmp(char*,</span> <span class="pre">char*,</span> <span class="pre">Py_ssize_t)</span></tt>. (Contributed by
Christian Heimes; issue 1635.)</p>
</li>
<li><p class="first">Many C extensions define their own little macro for adding integers
and strings to the module&#8217;s dictionary in the <tt class="docutils literal"><span class="pre">init*</span></tt> function.
Python 2.6 finally defines standard macros for adding values to a
module, <tt class="docutils literal"><span class="pre">PyModule_AddStringMacro</span></tt> and <tt class="docutils literal"><span class="pre">PyModule_AddIntMacro()</span></tt>.
(Contributed by Christian Heimes.)</p>
</li>
<li><p class="first">Some macros were renamed in both 3.0 and 2.6 to make it clearer that
they are macros, not functions.  <tt class="docutils literal"><span class="pre">Py_Size()</span></tt> became <tt class="docutils literal"><span class="pre">Py_SIZE()</span></tt>,
<tt class="docutils literal"><span class="pre">Py_Type()</span></tt> became <tt class="docutils literal"><span class="pre">Py_TYPE()</span></tt>, and <tt class="docutils literal"><span class="pre">Py_Refcnt()</span></tt> became
<tt class="docutils literal"><span class="pre">Py_REFCNT()</span></tt>. The mixed-case macros are still available in Python
2.6 for backward compatibility. (issue 1629)</p>
</li>
<li><p class="first">Distutils now places C extensions it builds in a different directory
when running on a debug version of Python. (Contributed by Collin
Winter; issue 1530959.)</p>
</li>
<li><p class="first">Several basic data types, such as integers and strings, maintain
internal free lists of objects that can be re-used.  The data
structures for these free lists now follow a naming convention: the
variable is always named <tt class="docutils literal"><span class="pre">free_list</span></tt>, the counter is always named
<tt class="docutils literal"><span class="pre">numfree</span></tt>, and a macro <tt class="docutils literal"><span class="pre">Py&lt;typename&gt;_MAXFREELIST</span></tt> is always
defined.</p>
</li>
<li><p class="first">A new Makefile target, &#8220;make patchcheck&#8221;, prepares the Python source
tree for making a patch: it fixes trailing whitespace in all
modified <tt class="docutils literal"><span class="pre">.py</span></tt> files, checks whether the documentation has been
changed, and reports whether the <tt class="docutils literal"><span class="pre">Misc/ACKS</span></tt> and <tt class="docutils literal"><span class="pre">Misc/NEWS</span></tt>
files have been updated. (Contributed by Brett Cannon.)</p>
<p>Another new target, &#8220;make profile-opt&#8221;, compiles a Python binary
using GCC&#8217;s profile-guided optimization.  It compiles Python with
profiling enabled, runs the test suite to obtain a set of profiling
results, and then compiles using these results for optimization.
(Contributed by Gregory P. Smith.)</p>
</li>
</ul>
<div class="section" id="port-specific-changes-windows">
<h3>Port-Specific Changes: Windows<a class="headerlink" href="#port-specific-changes-windows" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The support for Windows 95, 98, ME and NT4 has been dropped. Python
2.6 requires at least Windows 2000 SP4.</p>
</li>
<li><p class="first">The new default compiler on Windows is Visual Studio 2008 (version
9.0). The build directories for Visual Studio 2003 (version 7.1) and
2005 (version 8.0) were moved into the PC/ directory. The new
<tt class="docutils literal"><span class="pre">PCbuild</span></tt> directory supports cross compilation for X64, debug
builds and Profile Guided Optimization (PGO). PGO builds are roughly
10% faster than normal builds.  (Contributed by Christian Heimes
with help from Amaury Forgeot d&#8217;Arc and Martin von Loewis.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">msvcrt</span></tt> module now supports both the normal and wide char
variants of the console I/O API.  The <tt class="docutils literal"><span class="pre">getwch()</span></tt> function reads a
keypress and returns a Unicode value, as does the <tt class="docutils literal"><span class="pre">getwche()</span></tt>
function.  The <tt class="docutils literal"><span class="pre">putwch()</span></tt> function takes a Unicode character and
writes it to the console. (Contributed by Christian Heimes.)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">os.path.expandvars()</span></tt> will now expand environment variables in
the form &#8220;%var%&#8221;, and &#8220;~user&#8221; will be expanded into the user&#8217;s home
directory path.  (Contributed by Josiah Carlson; issue 957650.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">socket</span></tt> module&#8217;s socket objects now have an <tt class="docutils literal"><span class="pre">ioctl()</span></tt>
method that provides a limited interface to the <tt class="docutils literal"><span class="pre">WSAIoctl()</span></tt>
system interface.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">_winreg</span></tt> module now has a function,
<tt class="docutils literal"><span class="pre">ExpandEnvironmentStrings()</span></tt>, that expands environment variable
references such as <tt class="docutils literal"><span class="pre">%NAME%</span></tt> in an input string.  The handle
objects provided by this module now support the context protocol, so
they can be used in <tt class="docutils literal"><span class="pre">with</span></tt> statements. (Contributed by Christian
Heimes.)</p>
<p><tt class="docutils literal"><span class="pre">_winreg</span></tt> also has better support for x64 systems, exposing the
<tt class="docutils literal"><span class="pre">DisableReflectionKey()</span></tt>, <tt class="docutils literal"><span class="pre">EnableReflectionKey()</span></tt>, and
<tt class="docutils literal"><span class="pre">QueryReflectionKey()</span></tt> functions, which enable and disable
registry reflection for 32-bit processes running on 64-bit systems.
(issue 1753245)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">msilib</span></tt> module&#8217;s <tt class="docutils literal"><span class="pre">Record</span></tt> object gained <tt class="docutils literal"><span class="pre">GetInteger()</span></tt>
and <tt class="docutils literal"><span class="pre">GetString()</span></tt> methods that return field values as an integer
or a string. (Contributed by Floris Bruynooghe; issue 2125.)</p>
</li>
</ul>
</div>
<div class="section" id="port-specific-changes-mac-os-x">
<h3>Port-Specific Changes: Mac OS X<a class="headerlink" href="#port-specific-changes-mac-os-x" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>When compiling a framework build of Python, you can now specify the
framework name to be used by providing the <em>&#8211;with-framework-name=</em>
option to the <strong>configure</strong> script.</li>
<li>The <tt class="docutils literal"><span class="pre">macfs</span></tt> module has been removed.  This in turn required the
<tt class="docutils literal"><span class="pre">macostools.touched()</span></tt> function to be removed because it depended
on the <tt class="docutils literal"><span class="pre">macfs</span></tt> module.  (issue 1490190)</li>
<li>Many other Mac OS modules have been deprecated and will removed in
Python 3.0: <tt class="docutils literal"><span class="pre">_builtinSuites</span></tt>, <tt class="docutils literal"><span class="pre">aepack</span></tt>, <tt class="docutils literal"><span class="pre">aetools</span></tt>,
<tt class="docutils literal"><span class="pre">aetypes</span></tt>, <tt class="docutils literal"><span class="pre">applesingle</span></tt>, <tt class="docutils literal"><span class="pre">appletrawmain</span></tt>, <tt class="docutils literal"><span class="pre">appletrunner</span></tt>,
<tt class="docutils literal"><span class="pre">argvemulator</span></tt>, <tt class="docutils literal"><span class="pre">Audio_mac</span></tt>, <tt class="docutils literal"><span class="pre">autoGIL</span></tt>, <tt class="docutils literal"><span class="pre">Carbon</span></tt>,
<tt class="docutils literal"><span class="pre">cfmfile</span></tt>, <tt class="docutils literal"><span class="pre">CodeWarrior</span></tt>, <tt class="docutils literal"><span class="pre">ColorPicker</span></tt>, <tt class="docutils literal"><span class="pre">EasyDialogs</span></tt>,
<tt class="docutils literal"><span class="pre">Explorer</span></tt>, <tt class="docutils literal"><span class="pre">Finder</span></tt>, <tt class="docutils literal"><span class="pre">FrameWork</span></tt>, <tt class="docutils literal"><span class="pre">findertools</span></tt>, <tt class="docutils literal"><span class="pre">ic</span></tt>,
<tt class="docutils literal"><span class="pre">icglue</span></tt>, <tt class="docutils literal"><span class="pre">icopen</span></tt>, <tt class="docutils literal"><span class="pre">macerrors</span></tt>, <tt class="docutils literal"><span class="pre">MacOS</span></tt>, <tt class="docutils literal"><span class="pre">macfs</span></tt>,
<tt class="docutils literal"><span class="pre">macostools</span></tt>, <tt class="docutils literal"><span class="pre">macresource</span></tt>, <tt class="docutils literal"><span class="pre">MiniAEFrame</span></tt>, <tt class="docutils literal"><span class="pre">Nav</span></tt>,
<tt class="docutils literal"><span class="pre">Netscape</span></tt>, <tt class="docutils literal"><span class="pre">OSATerminology</span></tt>, <tt class="docutils literal"><span class="pre">pimp</span></tt>, <tt class="docutils literal"><span class="pre">PixMapWrapper</span></tt>,
<tt class="docutils literal"><span class="pre">StdSuites</span></tt>, <tt class="docutils literal"><span class="pre">SystemEvents</span></tt>, <tt class="docutils literal"><span class="pre">Terminal</span></tt>, and
<tt class="docutils literal"><span class="pre">terminalcommand</span></tt>.</li>
</ul>
</div>
<div class="section" id="port-specific-changes-irix">
<h3>Port-Specific Changes: IRIX<a class="headerlink" href="#port-specific-changes-irix" title="Permalink to this headline">¶</a></h3>
<p>A number of old IRIX-specific modules were deprecated and will be
removed in Python 3.0: <tt class="docutils literal"><span class="pre">al</span></tt> and <tt class="docutils literal"><span class="pre">AL</span></tt>, <tt class="docutils literal"><span class="pre">cd</span></tt>, <tt class="docutils literal"><span class="pre">cddb</span></tt>,
<tt class="docutils literal"><span class="pre">cdplayer</span></tt>, <tt class="docutils literal"><span class="pre">CL</span></tt> and <tt class="docutils literal"><span class="pre">cl</span></tt>, <tt class="docutils literal"><span class="pre">DEVICE</span></tt>, <tt class="docutils literal"><span class="pre">ERRNO</span></tt>, <tt class="docutils literal"><span class="pre">FILE</span></tt>,
<tt class="docutils literal"><span class="pre">FL</span></tt> and <tt class="docutils literal"><span class="pre">fl</span></tt>, <tt class="docutils literal"><span class="pre">flp</span></tt>, <tt class="docutils literal"><span class="pre">fm</span></tt>, <tt class="docutils literal"><span class="pre">GET</span></tt>, <tt class="docutils literal"><span class="pre">GLWS</span></tt>, <tt class="docutils literal"><span class="pre">GL</span></tt> and
<tt class="docutils literal"><span class="pre">gl</span></tt>, <tt class="docutils literal"><span class="pre">IN</span></tt>, <tt class="docutils literal"><span class="pre">IOCTL</span></tt>, <tt class="docutils literal"><span class="pre">jpeg</span></tt>, <tt class="docutils literal"><span class="pre">panelparser</span></tt>, <tt class="docutils literal"><span class="pre">readcd</span></tt>,
<tt class="docutils literal"><span class="pre">SV</span></tt> and <tt class="docutils literal"><span class="pre">sv</span></tt>, <tt class="docutils literal"><span class="pre">torgb</span></tt>, <tt class="docutils literal"><span class="pre">videoreader</span></tt>, and <tt class="docutils literal"><span class="pre">WAIT</span></tt>.</p>
</div>
</div>
<div class="section" id="porting-to-python-2-6">
<h2>Porting to Python 2.6<a class="headerlink" href="#porting-to-python-2-6" title="Permalink to this headline">¶</a></h2>
<p>This section lists previously described changes and other bugfixes
that may require changes to your code:</p>
<ul>
<li><p class="first">Classes that aren&#8217;t supposed to be hashable should set <tt class="docutils literal"><span class="pre">__hash__</span> <span class="pre">=</span>
<span class="pre">None</span></tt> in their definitions to indicate the fact.</p>
</li>
<li><p class="first">String exceptions have been removed.  Attempting to use them raises
a <tt class="docutils literal"><span class="pre">TypeError</span></tt>.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">__init__()</span></tt> method of <tt class="docutils literal"><span class="pre">collections.deque</span></tt> now clears any
existing contents of the deque before adding elements from the
iterable.  This change makes the behavior match <tt class="docutils literal"><span class="pre">list.__init__()</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">object.__init__()</span></tt> previously accepted arbitrary arguments and
keyword arguments, ignoring them.  In Python 2.6, this is no longer
allowed and will result in a <tt class="docutils literal"><span class="pre">TypeError</span></tt>.  This will affect
<tt class="docutils literal"><span class="pre">__init__()</span></tt> methods that end up calling the corresponding method
on <tt class="docutils literal"><span class="pre">object</span></tt> (perhaps through using <tt class="docutils literal"><span class="pre">super()</span></tt>). See issue 1683368
for discussion.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">Decimal</span></tt> constructor now accepts leading and trailing
whitespace when passed a string.  Previously it would raise an
<tt class="docutils literal"><span class="pre">InvalidOperation</span></tt> exception.  On the other hand, the
<tt class="docutils literal"><span class="pre">create_decimal()</span></tt> method of <tt class="docutils literal"><span class="pre">Context</span></tt> objects now explicitly
disallows extra whitespace, raising a <tt class="docutils literal"><span class="pre">ConversionSyntax</span></tt>
exception.</p>
</li>
<li><p class="first">Due to an implementation accident, if you passed a file path to the
built-in  <tt class="docutils literal"><span class="pre">__import__()</span></tt> function, it would actually import the
specified file.  This was never intended to work, however, and the
implementation now explicitly checks for this case and raises an
<tt class="docutils literal"><span class="pre">ImportError</span></tt>.</p>
</li>
<li><p class="first">C API: the <tt class="docutils literal"><span class="pre">PyImport_Import()</span></tt> and <tt class="docutils literal"><span class="pre">PyImport_ImportModule()</span></tt>
functions now default to absolute imports, not relative imports.
This will affect C extensions that import other modules.</p>
</li>
<li><p class="first">C API: extension data types that shouldn&#8217;t be hashable should define
their <tt class="docutils literal"><span class="pre">tp_hash</span></tt> slot to <tt class="docutils literal"><span class="pre">PyObject_HashNotImplemented()</span></tt>.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">socket</span></tt> module exception <tt class="docutils literal"><span class="pre">socket.error</span></tt> now inherits from
<tt class="docutils literal"><span class="pre">IOError</span></tt>.  Previously it wasn&#8217;t a subclass of <tt class="docutils literal"><span class="pre">StandardError</span></tt>
but now it is, through <tt class="docutils literal"><span class="pre">IOError</span></tt>. (Implemented by Gregory P.
Smith; issue 1706815.)</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">xmlrpclib</span></tt> module no longer automatically converts
<tt class="docutils literal"><span class="pre">datetime.date</span></tt> and <tt class="docutils literal"><span class="pre">datetime.time</span></tt> to the
<tt class="docutils literal"><span class="pre">xmlrpclib.DateTime</span></tt> type; the conversion semantics were not
necessarily correct for all applications.  Code using <tt class="docutils literal"><span class="pre">xmlrpclib</span></tt>
should convert <tt class="docutils literal"><span class="pre">date</span></tt> and <tt class="docutils literal"><span class="pre">time</span></tt> instances. (issue 1330538)</p>
</li>
<li><p class="first">(3.0-warning mode) The <tt class="docutils literal"><span class="pre">Exception</span></tt> class now warns when accessed
using slicing or index access; having <tt class="docutils literal"><span class="pre">Exception</span></tt> behave like a
tuple is being phased out.</p>
</li>
<li><p class="first">(3.0-warning mode) inequality comparisons between two dictionaries
or two objects that don&#8217;t implement comparison methods are reported
as warnings.  <tt class="docutils literal"><span class="pre">dict1</span> <span class="pre">==</span> <span class="pre">dict2</span></tt> still works, but <tt class="docutils literal"><span class="pre">dict1</span> <span class="pre">&lt;</span> <span class="pre">dict2</span></tt>
is being phased out.</p>
<p>Comparisons between cells, which are an implementation detail of
Python&#8217;s scoping rules, also cause warnings because such comparisons
are forbidden entirely in 3.0.</p>
</li>
</ul>
</div>
<div class="section" id="acknowledgements">
<h2>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permalink to this headline">¶</a></h2>
<p>The author would like to thank the following people for offering
suggestions, corrections and assistance with various drafts of this
article: Georg Brandl, Steve Brown, Nick Coghlan, Ralph Corderoy, Jim
Jewett, Kent Johnson, Chris Lambacher,  Martin Michlmayr, Antoine
Pitrou, Brian Warner.</p>
</div>
</div>


          </div>
        </div>
      </div>


      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../index.html">Jython v2.5.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; <a href="../copyright.html">Copyright</a> 2009, Jython Project.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.1.
    </div>
  </body>
</html>